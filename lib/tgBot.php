<?php
// First, you must setWebhook
// https://api.telegram.org/bot{$botinfo['token']}/setWebhook?url=https://{$host}/bots/hook.php?bot={$botinfo['name']}

$data = file_get_contents('php://input'); // –≤–µ—Å—å input –∑–∞–≥–∞–Ω—è—î–º–æ —É $data
$data = json_decode($data, true);         // –¥–µ–∫–æ–¥—É—î–º–æ json –¥–∞–Ω—ñ –≤ –º–∞—Å–∏–≤
if (empty($data)) {
  exit('empty input data');
  }

// –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
require_once $_SERVER['DOCUMENT_ROOT'] . "/load.php";
// –í–∏—Ö–æ–¥–∏–º–æ, —è–∫—â–æ mysql –±–∞–∑–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
if (!core::$db) {
  exit('error connect or install');
  }

// –û–≥–æ–ª–æ—à—É—î–º–æ –¥–µ—è–∫—ñ –∑–º—ñ–Ω–Ω—ñ
$text = false;          // –¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —â–æ –ø–æ—Å—Ç—É–ø–∏–≤ (–º–æ–∂–µ –±—É—Ç–∏ –ø—É—Å—Ç–∏–º, —è–∫—â–æ –ø—Ä–∏–π—à–ª–æ –Ω–µ —Ç–µ–∫—Å—Ç–æ–≤–µ)
$reply_author = false;  // –•—Ç–æ –∞–≤—Ç–æ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ —è–∫–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—å (—è–∫—â–æ —Ü–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—å)
$reply_message = false; // –¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ —è–∫–µ –º–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
$callback_data = false; // –Ü–Ω–ª–∞–π–Ω –∫–Ω–æ–ø–∫–∞ –ø–æ —è–∫—ñ–π –≤—ñ–¥–±—É–≤—Å—è –∫–ª—ñ–∫
$message_id = false;    // ID –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
$username = "";         // –Æ–∑–µ—Ä–Ω–µ–π–º –º–æ–∂–µ –±—É—Ç–∏ –ø—É—Å—Ç–∏–º, —è–∫—â–æ –≤ —é–∑–µ—Ä–∞ –≤—ñ–Ω –ø—É—Å—Ç–∏–π
$user = false;          // –Ø–∫—â–æ –¥—ñ—é —Ö—Ç–æ—Å—å —ñ–Ω—ñ—Ü—ñ—é–≤–∞–≤, —Ç–æ —Ö—Ç–æ? –ö–æ–º—É –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–∏ –≤ –æ—Å–æ–±–∏—Å—Ç—ñ
$chat = false;          // –ß–∞—Ç –≤ —è–∫–æ–º—É –≤—Å–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è
$allowbot = false;      // –ß–∏ –¥–æ–∑–≤–æ–ª–µ–Ω–æ –±–æ—Ç—É –±—É—Ç–∏ –≤ —á–∞—Ç—ñ? –í –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö —á–∞—Ç–∞—Ö –Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ
$client = false;        // –ó–∞—Å—Ç–∞—Ä—ñ–ª–æ, –ø–æ—Ç—Ä–æ—Ö—É —Ç—Ä–µ–±–∞ –≤–∏–¥–∞–ª–∏—Ç–∏
$cutt = false;          // –ü–µ—Ä–≤–∏–Ω–Ω–∞ –∫–æ–º–∞–Ω–¥–∞-–¥—ñ—è —â–æ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –∫–ª—ñ–∫–æ–º –ø–æ —ñnline –∫–Ω–æ–ø—Ü—ñ
$cqid = false;          // ID callback –∑–∞–ø–∏—Ç—É –Ω–∞ —è–∫–µ —Ç—Ä–µ–±–∞ –¥–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å (—è–∫—â–æ —Ü–µ callback –∑–∞–ø–∏—Ç)
$user_key = false;      // –î–æ–ø–æ–º–æ–≥–∞—î —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏, –∞–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
$partner = false;       // –ü–æ–≤–Ω–∞ –∞–Ω–∫–µ—Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Å–∞–π—Ç—É (—è–∫—â–æ –±–æ—Ç –ø—Ä–∞—Ü—é—î –≤ –∑–≤'—è–∑—Ü—ñ –∑ —Å–∞–π—Ç–æ–º)
$bundle = false;        // –ë–∞–∑–æ–≤–∞ –∞–Ω–∫–µ—Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±–æ—Ç—É
$isAdmin = false;       // –ß–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–¥–º—ñ–Ω? –ê–¥–º—ñ–Ω –º–∞—î –ø–æ–≤–Ω—É –≤–ª–∞–¥—É –Ω–∞–¥ –±–æ—Ç–æ–º
$isUsher = false;       // –ß–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–¥–µ—Ä–∞—Ç–æ—Ä? –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä - –º–∞—î –æ–±–º–µ–∂–µ–Ω—É –≤–ª–∞–¥—É —è–∫—É –π–æ–º—É –Ω–∞–¥–∞—î –∞–¥–º—ñ–Ω
$userbot = false;       // –ß–∏ —î —ñ–Ω—ñ—Ü—ñ–∞—Ç–æ—Ä –∑–∞–ø–∏—Ç—É –¥–æ —Ö—É–∫—É - –±–æ—Ç–æ–º?
$chattype = false;      // –¶–µ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π —á–∞—Ç —á–∏ –ø—É–±–ª—ñ—á–Ω–∏–π?
$groupsetup = false;    // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—É–±–ª—ñ—á–Ω–æ–≥–æ —á–∞—Ç—É –≤ —è–∫–æ–º—É –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –¥—ñ–∞–ª–æ–≥

if (!empty($_GET['bot'])) {
  $nameBot = $_GET['bot'];
  } else {
  // –≤–∏—Ö–æ–¥–∏–º–æ
  exit('webhook installed incorrectly<br><br>
  <a href="https://github.com/uwayit/php-telegram-bot-service/blob/main/docs/setWebhook.en.md" target="_blank">need get botname</a>');
  }

// –®—É–∫–∞—î–º–æ —ñ–Ω—Ñ—É –ø—Ä–æ –±–æ—Ç–∞
$botinfo = tg::getBotInfo($nameBot, 'work');
// –í–∏—Ö–æ–¥–∏–º–æ —è–∫—â–æ –Ω–µ –∑–Ω–∞–π—à–ª–∏
if ($botinfo == false) {
  exit('The row with information about this BOT is missing in the database');
  }
// –í–∫–∞–∑—É—î–º–æ —Ç–∏–ø –±–æ—Ç–∞
$st = $botinfo["type"];
/*
–Ø–∫—â–æ $st = bot - –∑–≥—ñ–¥–Ω–æ –∑ –∑–∞–¥—É–º–æ–º —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Ü–µ–π –±–æ—Ç –Ω–µ —î —á–∞—Å—Ç–∏–Ω–æ—é —è–∫–æ–≥–æ—Å—å —Å–∞–π—Ç—É —ñ –Ω–∞—Ä–∞–∑—ñ –ø—Ä–∞—Ü—é—î –≤—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω–æ
–í—Å—ñ –±–æ—Ç—ñ —è–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∑ –≥—ñ—Ç—Ö–∞–± —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –ø–æ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—é –ù–ï –Ñ —á–∞—Å—Ç–∏—Ç–æ—é —Å–∞–π—Ç—É
–ö–æ–ª–∏ –±–æ—Ç —î —á–∞—Å—Ç–∏–Ω–æ—é —Å–∞–π—Ç—É, —Ç–æ –¥–æ –ø—Ä–∏–∫–ª–∞–¥—É –≤—ñ–Ω –º–æ–∂–µ –º–∞—Ç–∏ –≤–µ–± —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–±–æ –º–æ–∂–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –±–∞–∑–æ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ 
–¢–ê–ö–û–ñ, –≤ –±–æ—Ç–∞ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Ä—ñ–∑–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ —è–∫—ñ –≤ –º–µ–Ω–µ –¥–æ–ø—Ä–∏–∫–ª–∞–¥—É –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ —Ç–∏–ø—É —Å–∞–π—Ç—É, —á–∞—Å—Ç–∏–Ω–æ—é —è–æ–∫–æ–≥–æ —î –±–æ—Ç
–¢–æ–∂ —è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é –∑–º—ñ–Ω—É $st —è–∫–∞ –¥–æ–ø–æ–º–æ–≥–∞—î hook —Ñ–∞–π–ª—É —Ä–æ–∑—É–º—ñ—Ç–∏ –∑–∞ —è–∫–∏–º —Å—Ü–µ–Ω–∞—Ä—ñ—î–º –æ–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏
*/
if ($st == 'bot') {
  // –û—Ç—Ä–∏–º—É—î–º–æ –¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é (–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è) –ø–æ —Ü—å–æ–º—É –±–æ—Ç—É
  $botinfodop = tg::getBotInfoDop($botinfo["id"]);
  }

// !!! –ù–ê–†–ê–ó–Ü –§–£–ù–ö–¶–Ü–û–ù–ê–õ $botinfo["type"] == bot
// !!! –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –Ω–∞ —Ç–µ, —â–æ–± –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ª–∏—à–µ –∑ –æ–¥–Ω—ñ—î—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—é –∫—Ä–∞—ó–Ω–æ—é
// !!! —Ç–æ–º—É $botinfo["country"] –º–∞—î –º—ñ—Å—Ç–∏—Ç–∏ –ª–∏—à–µ –æ–¥–Ω—É –∫—Ä–∞—ó–Ω—É
// –ó–º—ñ–Ω—é–≤–∞—Ç–∏ —Ü–µ –ø–æ–∫–∏ —â–æ –Ω–µ –ø–ª–∞–Ω—É—é
// –ü–æ–∫–∏ –ø—Ä–æ—Å—Ç—ñ—à–µ —è–∫ –Ω–∞ –º–µ–Ω–µ –¥–ª—è –∫–æ–∂–Ω–æ—ó –∫—Ä–∞—ó–Ω–∏ –º–∞—Ç–∏ –æ–∫—Ä–µ–º–∏–π –±–æ—Ç
// –ö—Ä–∞—ó–Ω–∞, –º–æ–≤–∞ —è–∫–æ—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –±–æ—Ç–æ–º –ø–æ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—é –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
$aco = $botinfo["country"];
$lg = $botinfo["country"];
// –ë–∞–∑–æ–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ª–æ–∫–∞–ª—å –±–æ—Ç–∞
// –ê–ª–µ –Ω–∏–∂—á–µ, –º–æ–∂–Ω–∞ –±—É–¥–µ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ª–æ–∫–∞–ª—å –∫–ª—ñ—î–Ω—Ç–∞
$locale = core::getLocal($aco);
// –û—Ç—Ä–∏–º—É—î–º–æ –¥–µ—Ç–∞–ª—ñ –ø–æ –∫—Ä–∞—ó–Ω—ñ
// –≤ –ø–µ—Ä—à—É —á–µ—Ä–≥—É –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–µ—Ä–µ–ª—ñ–∫—É –ø—Ä–æ–±–ª–µ–º–Ω–∏—Ö —Ä–µ–≥—ñ–æ–Ω—ñ–≤
$setAco = core::getSetupByCountry($aco);
/*
–§–æ—Ä–º—É—î–º–æ –ø–µ—Ä–µ–ª—ñ–∫ –ø—Ä–æ–±–ª–µ–º–Ω–∏—Ö —Ä–µ–≥—ñ–æ–Ω—ñ–≤ 
–í —è–∫–∏—Ö –π–¥—É—Ç—å –±–æ–π–æ–≤—ñ –¥—ñ—ó –∞–±–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —â–æ—Å—å —ñ–Ω—à–µ —â–æ –∑–∞–≤–∞–∂–∞—î –¥–æ—Å—Ç–∞–≤—Ü—ñ —Ç—É–¥–∏ —Ç–æ–≤–∞—Ä—É –∞–±–æ –Ω–∞–¥–∞–Ω—é —Ç–∞–º –ø–æ—Å–ª—É–≥
–¶–µ–π —Å–ø–∏—Å–æ–∫ erReg –º–æ–∂–Ω–∞ –ø–æ—Å—Ç—ñ–π–Ω–æ –º–∞–Ω—É–∞–ª—å–Ω–æ –∫–æ—Ä–∏–≥—É–≤–∞—Ç–∏ –≤ –±–∞–∑—ñ –≤ —Ç–∞–±–ª–∏—Ü—ñ countries –≤–∫–ª—é—á–∞—é—á–∏ —Ç—É–¥–∏ —Ä–µ–≥—ñ–æ–Ω–∏ (–æ–±–ª–∞—Å—Ç—ñ —Ç–∞ –º—ñ—Å—Ç–∞)
–í –±—É–¥—å —è–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö –Ω–∏–∂—á–µ –ø—Ä–æ–±–ª–µ–º–Ω—ñ —Ä–µ–≥—ñ–æ–Ω–∏/–º—ñ—Å—Ç–∞ (–Ω–∞–∑–≤–∞ –º–∞—î –ø–æ–≤–Ω—ñ—Å—Ç—é —Å–ø—ñ–≤–ø–∞–¥–∞—Ç–∏ –∑ —Ü—ñ–ª—å–æ–≤–∏–º –∑ —Ç–∞–±–ª–∏—Ü—ñ regions) 
–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–ª—é—á–∞—é—Ç—å—Å—è –∑—ñ —Å–ø–∏—Å–∫—ñ–≤ —è–∫—ñ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å—Å—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
*/
$listProblemRegion = false;
if (!empty($setAco['erReg'])) {
  $listproreg = explode(",", $setAco['erReg']);
  $lpr = array_map('trim', $listproreg);
  $listProblemRegion = $lpr;
  }

// –°–∞–π—Ç –Ω–∞ —è–∫–æ–º—É (–≤—ñ–¥ —ñ–º–µ–Ω—ñ —è–∫–æ–≥–æ) –ø—Ä–∞—Ü—é—î –±–æ—Ç
$host = $botinfo["site"];
// –Ø–∫—â–æ —Å–∞–π—Ç –Ω–µ –≤–∫–∞–∑–∞–Ω–æ —á–æ–º—É—Å—å
// –û—Ç—Ä–∏–º—É—î–º–æ —Å–∞–π—Ç –Ω–∞ —è–∫–æ–º—É –∑–Ω–∞—Ö–æ–¥–∏–º–æ—Å—è
// –î–ª—è –º–µ–Ω–µ —Ü–µ –ø—Ä–∏–π–Ω—è—Ç–Ω–æ, –∞–ª–µ –Ω–µ –≤—Å—ñ–º —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –∑—Ä—É—á–Ω–æ
// –ë–æ —Å–∞–π—Ç –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –≤ —Ç–æ–º—É —á–∏—Å–ª—ñ —ñ –¥–ª—è —Ç–æ–≥–æ —â–æ–± –≤—ñ–¥ –π–æ–≥–æ —Ü–º–µ–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ –ª–∏—Å—Ç–∏
// –¢–æ–∂ —è–∫—â–æ –í–∏ —Ö–æ—Å—Ç–∏—Ç–µ –≤ —Å–µ–±–µ –±–∞–≥–∞—Ç–æ –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏—Ö –±–æ—Ç—ñ–≤, —Ç–æ 
// –º–æ–∂–ª–∏–≤–æ –í–∏ –Ω–µ —Ö–æ—á–µ—Ç–µ, —â–æ–± –≤—ñ–¥ –í–∞—à–æ–≥–æ —Ö–æ—Å—Ç—É –≤—ñ–¥–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ –ª–∏—Å—Ç–∏
if (empty($host)) {
  $host = core::getCurrentDomainByServerHttpHost();
  }

// –®—É–∫–∞—î–º–æ —Å–∞–π—Ç –≤ –±–∞–∑—ñ. –í—ñ–Ω –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –º–∞—î –±—É—Ç–∏ –ø—Ä–æ–ø–∏—Å–∞–Ω–∏–π –≤ —Ç–∞–±–ª–∏—Ü—ñ sites
// –¶–µ–π –º–∞—Å—Å–∏–≤ –ø–æ—Ç—Ä—ñ–±–µ–Ω —è–∫ –º—ñ–Ω—ñ–º—É–º:
// –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ä–µ–∂–∏–º—É —Ä–æ–±–æ—Ç–∏ —Ç–∞ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ª–∏—Å—Ç—ñ–≤ –Ω–∞ –µ–º–∞—ñ–ª
$site = core::getSiteByDomain($host);
if ($site == false) {
  exit('The row with information about this SITE is missing in the database');
  }

// –†–µ–∂–∏–º —Ä–æ–±–æ—Ç–∏ —Å–µ—Ä–≤—ñ—Å—É WORK|TEST
// –í lib/load –º–æ–∂–Ω–∞ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º—É –≤–∫–∞–∑–∞—Ç–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –≤—Å—ñ—Ö –∞–±–æ –æ–∫—Ä–µ–º–∏—Ö —Ç–∞–±–ª–∏—Ü—å
// –¢–∞ –ø–µ—Ä–µ–º–∏–∫–∞—Ç–∏—Å—å –Ω—ñ–∂ –Ω–∏–º–∏ –≤ –±—É–¥—å —è–∫–∏–π –º–æ–º–µ–Ω—Ç –≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏
// load::setMode("TEST");
// –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–æ, —è–∫—â–æ —Ç—Ä–µ–±–∞ –Ω–∞–ø—Ä–∏–∫–ª–∞–¥
// –º–∞–Ω—É–∞–ª—å–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ —è–∫ –ø—Ä–∞—Ü—é—î –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —Å–∫—Ä–∏–ø—Ç —â–æ —Ä–æ–∑—Å–∏–ª–∞—î –ø–æ –±–∞–∑—ñ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
load::setMode($site["MODE"]);

// Get the bot object
$bot = new tgBot($botinfo['token'], $botinfo['name'], $host);
if (!core::$db) {
  // –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø—Ä–æ—Å—Ç–∏–π –±–æ—Ç –±–µ–∑ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–Ω–∏—Ö
  // –í —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤—ñ–¥–∫–ª—é—á–∞—î–º–æ —É–≤–µ—Å—å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª —è–∫–∏–π –ø—Ä—è–º–æ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –±–∞–∑–∏ –¥–∞–Ω–Ω–∏—Ö
  $bot->liteModeOn();
  }

// –û—Ç—Ä–∏–º—É—î–º–æ chat_id –∞–¥–º—ñ–Ω—ñ–≤ –±–æ—Ç—É
$admins = explode(",", $botinfo['admins']);

// –ú–∏ –º–æ–∂–µ–º–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è 
// –ø—Ä–æ –≤—Å—ñ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è hook —è–∫—ñ –≤—ñ–¥–±—É–≤–∞—é—Ç—å—Å—è –¥–∞–ª—ñ –ø–æ –∫–æ–¥—É
// –ü–æ–º–∏–ª–∫–∏ —è–∫—ñ –≤—ñ–¥–±—É–≤–∞—é—Ç—å—Å—è –≤–∏—â–µ —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ load.php 
if (!empty($admins[0])) {
  // –Ø –ø–æ—î–¥–Ω—É—é –≤ —Å–æ–±—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∞–¥–º—ñ–Ω–∞ –±–æ—Ç–∞ —Ç–∞ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞, —Ç–æ–º—É –Ω–µ —Ä–æ–∑–¥—ñ–ª—è—é —Ç—É—Ç —Ä–æ–ª—ñ
// –ê–ª–µ —è–∫—â–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ, –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–∫—Ä–µ–º–∏–π —Å—Ç–æ–≤–ø–µ—Ü—å –¥–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏–º–µ—Ç–µ chat_id —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤
  $devAdmin = $admins[0];
  // –û–±—Ä–æ–±–Ω–∏–∫ –ø–æ–º–∏–ª–æ–∫ —â–æ –Ω–∞–¥—Å–∏–ª–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç –∞–¥–º—ñ–Ω–∞
  $errorHandler = new ErrorHandler(core::$db, 'tg', $bot, $devAdmin);
  $errorHandler->register();
  }

// –í–∏–∑–Ω–∞—á–∞—î–º–æ –∑ —è–∫–æ–≥–æ –º–∏–ª–∞ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏–º–µ–º–æ –ª–∏—Å—Ç–∏ –Ω–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É
// –õ–∏—Å—Ç –ø–æ—Ç—Ä—ñ–±–µ–Ω –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —è–∫—â–æ –º–∏ –∑–∞–ø–∏—Ç—É—î–º–æ –≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –µ–º–∞—ñ–ª —ñ —Ç—Ä–µ–±–∞ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∫–æ–¥ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –µ–º–∞—ñ–ª
if (empty($botinfo['info_email'])) {
  $infoemail = $site["info_email"];
  } else {
  $infoemail = $botinfo["info_email"];
  }

// –°—Ç–∞—Ä—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —è–∫–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫—â–æ/–∫–æ–ª–∏ —Ç—Ä–µ–±–∞ –≤–∫–∞–∑–∞—Ç–∏ —é–∑–µ—Ä—É
// —â–æ –ø–µ—Ä—à –Ω—ñ–∂ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—å –≤ –±–æ—Ç—ñ, —Ç—Ä–µ–±–∞ —Å–ø–æ—á–∞—Ç–∫—É –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—å –Ω–∞ —Å–∞–π—Ç—ñ
if ($bot->FullMode == true and $st != 'bot') {
  $textNeedRegSite = tg::textNeedRegSite($st, $lg, $host);
  }

// –ó–∞–¥–∞—î–º–æ –±–∞–∑–æ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–≤—Ç–æ–ø—ñ–¥–º—ñ–Ω–∏ —è–∫–æ—Ä—ñ–≤ –≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è—Ö
// –¶–µ –¥–ª—è –º–µ–Ω–µ –≤–∂–µ —Ä—É–¥—ñ–º–µ–Ω—Ç, –±–æ 
// —é–∑–∞–≤ –∫–æ–ª–∏ —Ç—è–≥–∞–≤ —Ç–µ–∫—Å—Ç–∏ –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑ –±–∞–∑–∏, –∞ –æ—Ç–∂–µ –≤ —Ç–µ–∫—Å—Ç–∞—Ö –Ω–µ –±—É–ª–æ –∑–º—ñ–Ω–Ω–∏—Ö
// –ê–ª–µ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –ª–∏—à–∞—é –ø—Ä–æ –≤—Å—è–∫
// –ü–µ—Ä–µ–¥ –≤—ñ–¥–ø—Ä–∞–≤–∫–æ—é –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ —è–∫–æ–º—É —Ç—Ä–µ–±–∞ –∑—Ä–æ–±–∏—Ç–∏ –∞–≤—Ç–æ–∑–∞–º—ñ–Ω—É 
// –¥–æ–¥–∞—î–º–æ —Ä—è–¥–æ–∫ $message = str_replace($billet, $repl, $message);
$billet[0] = "{host}";
$repl[0] = $host;

// –î–ª—è –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –≤ –æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—ñ
// !!! —Ç—Ä–µ–±–∞ –Ω–µ –∑–∞–±—É–≤–∞—Ç–∏ –≤–∏–º–∏–∫–∞—Ç–∏ –ø—ñ—Å–ª—è –¥–µ–±–∞–≥—ñ–Ω–≥—É –±–æ —Ü–µ –º—É—Å–æ—Ä–∏—Ç—å —Å–∏–ª—å–Ω–æ –≤ –ø–∞–ø–∫—É bots/$botinfo['name']/
//$bot->botLog($botinfo['name'], 'all_in', $data, 'debug');

// ** –ü–æ—á–∏–Ω–∞—î–º–æ —Ä–æ–∑–±–∏—Ä–∞—Ç–∏ –≤—Ö—ñ–¥–Ω–∏–π –º–∞—Å–∏–≤

// –Ø–∫—â–æ —Ü–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
if (!empty($data['message'])) {
  // –°—Ç—Ä–∞–Ω–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –æ—Ç–ª–∞–≤–ª–∏–≤–∞—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏
  // –Ø–∫—â–æ —á–∞—Ç –≤ —è–∫–æ–º—É —ñ–¥–µ –¥—ñ–∞–ª–æ–≥ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ –Ω–∞–º 
  if (empty($data['message']['chat']['id'])) {
    // –ó–∞—Ä–∞–∑ –ø—Ä–æ—Å—Ç–æ –ª–æ–≥—É—é 
    $bot->botLog($botinfo['name'], 'error_chat_id', $data, 'uvaga');
    exit('end');
    }
  // –ó–∞–ø–æ–≤–Ω—é—î–º–æ –∑–º—ñ–Ω–Ω—ñ
  $chat = $data['message']['chat']['id'];
  $chattype = $data['message']['chat']['type'];
  $user = $data['message']['from']['id'];
  $userbot = $data['message']['from']['is_bot'];
  $first_name = $data['message']['from']['first_name'];
  $message_id = $data['message']['message_id'];
  if (!empty($data['message']['from']['username'])) {
    $username = $data['message']['from']['username'];
    }
  // –ø–æ–ª—É—á–∞–µ–º –¢–ï–ö–°–¢–û–í–û–ï —Å–æ–æ–±—â–µ–Ω–∏–µ, —á—Ç–æ —é–∑–µ—Ä –æ—Ç–ø—Ä–∞–≤–∏–ª –±–æ—Ç—É –∏ 
  // –∑–∞–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  if (!empty($data['message']['text'])) {
    $text = trim($data['message']['text']);
    }
  if (!empty($data['message']['reply_to_message']['from']['id'])) {
    $reply_author = $data['message']['reply_to_message']['from']['id'];
    }
  if (!empty($data['message']['reply_to_message']['message_id'])) {
    $reply_message = $data['message']['reply_to_message']['message_id'];
    }
  }
// –Ø–∫—â–æ —Ü–µ –∫–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ
if (!empty($data['callback_query'])) {
  // –ß–∞—Ç –¥–µ –≤—Å–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è
  $chat = $data['callback_query']['message']['chat']['id'];

  $chattype = $data['callback_query']['message']['chat']['type'];
  $first_name = $data['callback_query']['from']['first_name'];
  if (!empty($data['callback_query']['from']['username'])) {
    $username = $data['callback_query']['from']['username'];
    }
  $user = $data['callback_query']['from']['id'];
  $cqid = $data['callback_query']['id'];
  $message_id = $data['callback_query']['message']['message_id'];

  // –¢–µ–∫—Å—Ç –æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏—à—ë–ª –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ callback
  // –Ü–Ω–∫–æ–ª–∏ —á–æ–º—É—Å—å –±—É–≤–∞—î –ø—É—Å—Ç–∏–º, –ø–æ–∫–∏ –Ω–µ —Ä–æ–∑—ñ–±—Ä–∞–≤—Å—è —á–æ–º—É
  if (!empty($data['callback_query']['message']['text'])) {
    $text = $data['callback_query']['message']['text'];
    } else {
    $text = 'empty';
    }
  $callback_data = $data['callback_query']['data'];
  $bot->forCallBack($cqid);
  }
// –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –æ—Ç—Ä–∏–º—É–≤–∞—á–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–ø–æ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—é)
// –í –ø–µ—Ä—à—É —á–µ—Ä–≥—É –≤–≤–∞–∂–∞—î–º–æ, —Ç–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î–º–æ –≤ —Ç–æ–π –∂–µ —á–∞—Ç –≤ —è–∫–æ–º—É –±—É–ª–æ –∑–∞–¥–∞–Ω–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
// –ê–ª–µ —è–∫—â–æ —Ü–µ –ø—É–±–ª—ñ—á–Ω–∏–π —á–∞—Ç —Ç–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î–º–æ –≤ –ø—Ä–∏–≤–∞—Ç–Ω—ñ
if ($chattype != 'private') {
  $groupsetup = tg::getGroup($chat, $chattype);
  $allowbot = core::inar($user, $groupsetup['bots']);
  $bot->for($chat);
  } else {
  $bot->for($user);
  }
// –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –Ω–æ–≤–æ–≥–æ —é–∑–µ—Ä–∞ –≤ —á–∞—Ç—ñ
if (
  empty($user) and isset($data['my_chat_member']['chat']['id']) and
  $chattype != 'private' and $chattype != 'channel'
) {

  $chat = $data['my_chat_member']['chat']['id'];
  $user = $data['my_chat_member']['chat']['id'];
  // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø—É–±–ª—ñ—á–Ω–∏–π —á–∞—Ç –∫—É–¥–∏ –±—É–¥–µ–º–æ –ø–∏—Å–∞—Ç–∏
  $bot->for($chat);

  // –ü—Ä–æ—à—É chatGPT –∑–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ –∫–µ–π—Å–∏ —Ç–æ–≥–æ, —â–æ –º–æ–∂–Ω–∞ —Ä–æ–±–∏—Ç–∏ —Ç—É—Ç 
  // (–≤—ñ—Ç–∞—Ç–∏—Å—å –∑ –Ω–æ–≤–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –π–æ–º—É –ø—Ä–∞–≤–∏–ª–∞ –≤ –æ—Å–æ–±–∏—Å—Ç—ñ —Ç–æ—â–æ)


  // –î–∞–ª—ñ
  // –Æ–∑–µ—Ä $data['my_chat_member']['from']['id'] 
  // –¥–æ–¥–∞–≤ —Ü—å–æ–≥–æ –±–æ—Ç–∞ –≤ –ß–ê–¢
  if (!empty($data['my_chat_member']['new_chat_member']) and $data['my_chat_member']['new_chat_member']['user']['id'] == $botinfo['from_id']) {
    //$bot->botLog($botinfo['name'],$chat,$data,'in_new_chat');

    // –©–æ —Ä–æ–±–∏–º–æ –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –±–æ—Ç –æ–ø–∏–Ω–∏–≤—Å—è –≤ —á–∞—Ç—ñ
    // –ë–æ—Ç –º–æ–∂–µ –ø—Ä–∏–≤—ñ—Ç–∞—Ç–∏—Å—å, —Ä–æ—Å–∫–∞–∑–∞—Ç–∏ –ø—Ä–æ —Å–≤–æ—ó –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —ñ –Ω–∞–≥–∞–¥–∞—Ç–∏ –ø—Ä–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –≤–∏–¥–∞—Ç–∏ –π–æ–º—É –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω–∞

    // –ê–±–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ —è–∫—ñ—Å—å –¥—ñ—ó –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –æ—Ç—Ä–∏–º–∞—î –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω–∞
    if ($data['my_chat_member']['new_chat_member']['status'] == 'administrator') {

      }
    exit('done');
    }
  }


// –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —î —É —Å–ø–∏—Å–∫—É –∞–¥–º—ñ–Ω—ñ–≤ —Ü—å–æ–≥–æ —Ä–æ–±–æ—Ç–∞
// –í–∏–¥–∞—î–º–æ –π–æ–º—É –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞
if (!empty($botinfo['admins'])) {
  $isAdmin = core::inar($user, $botinfo['admins']);
  }
// –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –¥–ª—è –ø–æ–º—ñ—á–Ω–∏–∫—ñ–≤, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ñ–≤, –±—ñ–ª–µ—Ç–µ—Ä—ñ–≤
if (!empty($botinfo['usher'])) {
  $isUsher = core::inar($user, $botinfo['usher']);
  }

// –Ø –ø–µ—Ä–µ–¥–±–∞—á–∏–≤ –≤ —Å–∏—Å—Ç–µ–º—ñ –ª–∏—à–µ –æ–¥–Ω—É –¥–æ–¥–∞—Ç–∫–æ–≤—É —Ä–æ–ª—å "–Ω–∏–∂—á—É" –∑–∞ –∞–¥–º—ñ–Ω–∞
// –Ø–∫—â–æ –≤–∞–º —Ç—Ä–µ–±–∞ –º–∞—Ç–∏ –±—ñ–ª—å—à–µ —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω–∏—Ö —Ä–æ–ª–µ–π –æ–¥–Ω–æ—á–∞—Å–Ω–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —Ä–æ–ª—å —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞), —Ç–æ–¥—ñ:
// –¥–æ–¥–∞–π—Ç–µ –¥–ª—è –Ω–∏—Ö –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —Å—Ç–æ–≤–±—Ü—ñ –≤ —Ç–∞–±–ª–∏—Ü—é tg_bots
// –û—Ç—Ä–∏–º—É–π—Ç–µ —ó—Ö —Ä–æ–ª—å –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –≤–∞—Ä—ñ–∞–Ω—Ç–∞–º –≤–∏—â–µ



// –Ø–∫—â–æ —Ü–µ –ø–æ—Å—Ç –Ω–∞ –∫–∞–Ω–∞–ª—ñ
if (!empty($data['channel_post'])) {
  $message_id = $data['channel_post']['message_id'];
  $chat = $data['channel_post']['chat']['id'];
  // –ú–æ–∂–µ–º–æ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø–æ—Å—Ç, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –¥–æ–¥–∞—Ç–∏ –∫–Ω–æ–ø–∫–∏
  // –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é $bot->editMessageText(...);

  exit('ok');
  }

// –Ø–∫—â–æ –º–∏ –Ω–µ –∑–Ω–∞–π—à–ª–∏ $chat —Ç–∞ $user, –∑–Ω–∞—á–∏—Ç—å –º–∏ —á–æ–≥–æ—Å—å —â–µ –Ω–µ –Ω–∞–≤—á–∏–ª–∏ –±–æ—Ç–∞
// –õ–æ–≥—É—î–º–æ —Ç–∞/–∞–±–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ alert –≤ slack —Ç–∞ –≤–∏—Ö–æ–¥–∏–º–æ
// –ü—Ä–æ—à—É chatGPT –≤–∫–∞–∑–∞—Ç–∏ —è–∫—ñ –∫–µ–π—Å–∏ –ø—Ä–æ–ø—É—â–µ–Ω—ñ (—á–µ—Ä–µ–∑ —â–æ –º–æ–∂–µ –≤–∏–Ω–∏–∫–∞—Ç–∏ —Å–∏—Ç—É–∞—Ü—ñ—è empty($chat) and empty($user)) —ñ –∑–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è
if (empty($chat) and empty($user)) {
  $bot->botLog($botinfo['name'], 'emptyUserChat', $data, 'hook');
  exit('ok');
  }


// $botinfo['some'] - —Ü–µ –ø–µ—Ä–µ–ª—ñ–∫ —á–∞—Ç—ñ–≤, —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∑–∞–ø–∏—Ç–∏ —è–∫–∏—Ö —Å–∞–º–µ —Ü–µ–π –±–æ—Ç –ø—Ä–æ—Å—Ç–æ –º–æ–≤—á–∏—Ç—å —è–∫ —Ä–∏–±–∞
// –Ü–Ω–∫–æ–ª–∏ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–æ, —Ç–æ–∂ –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞—î–º–æ —Ç–∞–∫–∏–π —á–∞—Ç —á–µ—Ä–µ–∑ –∫–æ–º—É –≤ $botinfo['some']
// –§—É–Ω–∫—Ü—ñ—è –ø—Ä–∏ —Ç–∞–∫–∏—Ö —á–∞—Ç–∞—Ö –∑–∞–≤–µ—Ä—à—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è - exit('ok');
tg::silentInChat($botinfo['some'], $chat);


// –®—É–∫–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ –±–∞–∑—ñ
// –Ø–∫—â–æ –≤ –±–∞–∑—ñ –Ω–µ–º–∞—î, —Ç–æ —Ç—Ä–æ—Ö–∏ –Ω–∏–∂—á–µ –±—É–¥–µ–º–æ –æ–¥—Ä–∞–∑—É –¥–æ–¥–∞–≤–∞—Ç–∏ –π–æ–≥–æ –≤ –±–∞–∑—É
$bundle = tg::SearchTgBundle($user, $botinfo['name']);

// –ù–µ–ø—É—Å–∫–∞—î–º–æ –¥–∞–ª—ñ —Ç–∏—Ö, —Ö—Ç–æ –≤ —á–æ—Ä–Ω–æ–º—É —Å–ø–∏—Å–∫—É, —Ç–æ–±—Ç–æ –º–∞—é—Ç—å $bundle['status'] == 'black'
// –¢–æ–±—Ç–æ –º–æ–∂–Ω–∞ –±—É–¥—å —è–∫–∏–π –∞–∫–∫–∞—É–Ω—Ç –ø–æ–º—ñ—á–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å–æ–º black (–≤ —Ç–∞–±–ª–∏—Ü—ñ tg_bundle) 
// —ñ –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –π–æ–≥–æ –∑–∞–±–ª–æ–∫—É—î –≤ –æ—Å–æ–±–∏—Å—Ç–∏—Ö —á–∞—Ç–∞—Ö —ñ —É—Å—é–¥–∏ –¥–µ —Ü–µ–π –±–æ—Ç –∞–¥–º—ñ–Ω (—Ü–µ —Ç—Ä–µ–±–∞ –≤—Ä–∞—Ö—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–¥ –≤–∏–¥–∞—á–æ—é black)
if (!empty($bundle) and !empty($bundle['status']) and $bundle['status'] == 'black') {
  $bot->tempban($user); // –ë–ª–æ–∫—É—î–º–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ 2048 —Ä–æ–∫—É
  exit('ok');
  }



// –Ø–∫—â–æ —Ü–µ–π –±–æ—Ç –≤–ø–µ—Ä—à–µ –∑—ñ—à—Ç–æ–≤—Ö–Ω—É–≤—Å—è –∑ –¥–∞–Ω–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º
// –í–Ω–æ—Å–∏–º–æ –≤—Å–µ —â–æ –∑–Ω–∞—î–º–æ –ø–æ –Ω—å–æ–º—É –≤ –±–∞–∑—É –¥–∞–Ω–Ω–∏—Ö
if (empty($bundle) and !empty($user)) {
  $advanced = false;
  // –§–æ—Ä–º—É—î–º–æ –ø–µ—Ä–≤–∏–Ω–∏–π –º–∞—Å—Å–∏–≤ –∑ –π–æ–≥–æ –¥–∞–Ω–Ω–∏–º–∏
  $bundle = [
    'from_id' => $user,
    'bot' => $botinfo['name'],
    'username' => $username,
    'phone' => '',
    'email' => '',
    'kod' => '',
    'region' => '',
    'city' => '',
    'mst' => '',
    'role' => '',
    'step' => '',
    'country' => '',
    'dopphone' => '',
    'date_phone' => '0000-00-00'
  ];

  // –ó–∞–ø–∏—Å—É—î–º–æ –≤—Å–µ —â–æ –º–∞—î–º–æ –≤ –±–∞–∑—É –¥–∞–Ω–Ω–∏—Ö
  core::$db->query("INSERT INTO `" . load::$tg_bundle . "` SET `from_id`='$user',`username`='$username', `bot`='{$botinfo['name']}', `date_reg` = NOW()" . $advanced);
  $bundle['id'] = mysqli_insert_id(core::$db);

  // –í –°–ò–¢–£–ê–¶–Ü–á –ö–û–õ–ò –°–ü–û–ß–ê–¢–ö–£ –ó–ê–Ø–í–ö–ê –ù–ê –°–ê–ô–¢–Ü –ü–û–¢–Ü–ú –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –ë–û–¢—É
  // –ù–∞–¥—Å–∏–ª–∞—î–º–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–π –≤–∏—â–µ —Ç–µ–∫—Å—Ç textNeedRegSite
  // —Ç–∞ –≤—ã—Ö–æ–¥–∏–º–æ
  if ($st == 'credit' and empty($partner) and $chattype == 'private') {
    $bot->hello($textNeedRegSite);
    exit('hello');
    }

  }






// –ó–∞–¥–∞—î–º–æ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ
// –ó–∞–¥–∞—î–º–æ –∫—Ä–∞—ó–Ω—É (–ø–µ—Ä–µ–∫–ª–∞–¥) –≤–∏—Ö–æ–¥—è—á–∏ –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
if (!empty($bundle['lg'])) {
  $lg = $bundle['lg'];
  $textNeedRegSite = tg::textNeedRegSite($st, $lg, $host);
  }

// –§–æ—Ä–º—É—î–º–æ –ø–æ–ø—É–ª—è—Ä–Ω—ñ –∑–º—ñ–Ω—ñ
$ua = "–í–ï–†–Ü–§–Ü–ö–£–í–ê–¢–ò –ù–û–ú–ï–† –¢–ï–õ–ï–§–û–ù–£";
$ru = "–í–ï–†–ò–§–ò–¶–ò–†–û–í–ê–¢–¨ –ù–û–ú–ï–† –¢–ï–õ–ï–§–û–ù–ê";
$en = "VERIFY PHONE NUMBER";
$sharecontact = mova::lg($lg, $ua, $ru, $en);
$ua = "–ü–û–í–ï–†–ù–£–¢–ò–°–¨ –ù–ê –ì–û–õ–û–í–ù–£";
$ru = "–í–ï–†–ù–£–¢–¨–°–Ø –ù–ê –ì–õ–ê–í–ù–£–Æ";
$en = "BACK TO THE MAIN PAGE";
$gotostart = mova::lg($lg, $ua, $ru, $en);


// –Ø–∫—â–æ –∫–ª—ñ—î–Ω—Ç —Ä–∞–Ω—ñ—à–µ –≤—ñ–¥–ø–∏—Å–∞–≤—Å—è, –ø—ñ–¥–ø–∏—Å—É—î–º–æ –π–æ–≥–æ –∑–Ω–æ–≤—É
if (!empty($bundle['mst']) and $bundle['mst'] == 'stop') {
  tg::UpdateTgBundle($user, $bundle['email'], $st, $nameBot);
  }

// –Ø–∫—â–æ —Ü–µ –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥, –æ—Ç—Ä–∏–º—É—î–º–æ –¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –Ω—å–æ–≥–æ –≤ –º–∞—Å—Å–∏–≤
if (!empty($bundle['role']) and $bundle['role'] == 'service') {
  $service = tg::getService($bundle['id']);
  // –í –¥–∞–Ω–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ç—Ä–µ–±–∞ –ø–æ–≤—ñ–¥–æ–º–∏—Ç–∏ –ê–î–ú–Ü–ù–ê, –©–û —è–∫–∏–π—Å—å –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥ –ù–ï –ú–ê–Ñ service –ø—Ä–æ—Ñ—ñ–ª—é
  // –ù–∞—Ä–∞–∑—ñ, –≤—Å—ñ –ø—Ä–æ—Ñ—ñ–ª—ñ –Ω–∞–¥–∞–≤–∞—á—ñ–≤ –ø–æ—Å–ª—É–≥ –≤–Ω–æ—Å—è—Ç—å—Å—è —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å phpMyAdmin
  if (empty($service)) {
    $bot->reply("–í–∞—à –ø—Ä–æ—Ñ—ñ–ª—å –Ω–µ–∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–π –∞–¥–º—ñ–Ω–æ–º...\r\n---\r\n–¶–µ –≤–∏–ø–∞–¥–∫–æ–≤–∞ –ø–æ–º–∏–ª–∫–∞ —ñ –º–∏ —ó—ó –≤–∏–ø—Ä–∞–≤–∏–º–æ!\r\n–ü–æ–≤—ñ–¥–æ–º—Ç–µ –Ω–∞–º –ø—Ä–æ –Ω–µ—ó –Ω–∞:\r\n" . $botinfo['manager_mail'] . "\r\n---\r\n–ü—Ä–∏–Ω–æ—Å–∏–º–æ –≤–∏–±–∞—á–µ–Ω–Ω—è –∑–∞ –Ω–µ–∑—Ä—É—á–Ω–æ—Å—Ç—ñ!");
    exit('ok');
    }

  }


// –Ø–∫—â–æ –∫–ª—ñ–µ–Ω—Ç –∑–º—ñ–Ω–∏–≤ username –∞–±–æ –π–æ–≥–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ–º–∞—î –≤ –Ω–∞—Å –≤ –±–∞–∑—ñ
// –ö–æ—Ä–∏–≥—É—î–º–æ –±–æ —ñ–º–µ–Ω–∞ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω—ñ
tg::UpdateUserName($username, $bundle['id'], $bundle['username']);



// –Ø–ö–©–û –ü–ï–†–ï–î –ù–ê–ú–ò –ö–ê–ù–ê–õ
if ($chattype == 'channel') {
  // –Ø–∫—â–æ –º–∏ —Ö–æ—á–µ–º–æ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ –∫–∞–Ω–∞–ª
  // –ù–∞–ø—Ä–∏–∫–ª–∞–¥ –¥–æ–¥–∞–≤–∞—Ç–∏ –¥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ –∫–∞–Ω–∞–ª—ñ - –∫–Ω–æ–ø–∫–∏
  // –¢–æ —Ä–æ–±–∏–º–æ —Ü–µ —Ç—É—Ç

  // –ü—ñ—Å–ª—è –≤–∏—Ö–æ–¥–∏–º–æ
  exit('ok');
  }


if ($chattype == 'group' or $chattype == 'supergroup') {
  // –Ø–∫—â–æ –¶–ï –¥–æ —á–∞—Ç—É –ø—Ä–∏–µ–¥–Ω–∞–≤—Å—è –Ω–æ–≤–∏–π —É—á–∞—Å–Ω–∏–∫
// –∞–±–æ
// –Ø–∫—â–æ –≤–∏–¥–∞–ª–∏–≤—Å—è —É—á–∞—Å–Ω–∏–∫
  if (isset($data['message']['new_chat_members']) or isset($data['message']['left_chat_member'])) {

    // –í–∏–¥–∞–ª—è—î–º–æ –º—É—Å–æ—Ä–Ω–µ (–Ü–ú–•–û) –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —Ñ–∞–∫—Ç –¥–æ—î–¥–Ω–∞–Ω–Ω—è –∞–±–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —É—á–∞—Å–Ω–∏–∫–∞
    $bot->deleteMessage($message_id);

    // –ù–∞—Ä–∞–∑—ñ –≤–∏—Ö–æ–¥–∏–º–æ, —Ö–æ—á–∞ –º–æ–∂–µ–º–æ —â–µ —â–æ—Å—å —Ä–æ–±–∏—Ç–∏ 
    // –¥–ª—è –Ω–æ–≤–µ–Ω—å–∫–æ–≥–æ, –ø–∏—Å–∞—Ç–∏ –π–æ–º—É –≤ –æ—Å–æ–±–∏—Å—Ç—ñ –Ω–∞–ø—Ä–∏–∫–ª–∞–¥
    exit('done');
    }
  // –Ø–∫—â–æ –≥—Ä—É–ø–∞ —Å—Ç–∞–ª–∞ —Å—É–ø–µ—Ä–≥—Ä—É–ø–æ—é, —Ç—Ä–µ–±–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ü–µ –≤–∏—è–≤–ª—è—Ç–∏ —ñ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –≥—Ä—É–ø–∏ –≤ –±–∞–∑—ñ
  if (isset($data['message']['migrate_to_chat_id']) and isset($data['message']['migrate_from_chat_id'])) {




    }
  }


// –Ø–∫ –±—É—Ç–∏ —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–¥—ñ—Å–ª–∞–≤ –±–æ—Ç—É —Ñ–æ—Ç–æ
if (!empty($data['message']['photo'])) {
  // –Ø–∫—â–æ —Ü–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –∫–∞–Ω–∞–ª—É –∞–±–æ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ —á–∞—Ç—É, —Ç–æ –±–æ—Ç –Ω–∞ –¥–∞–Ω–æ–º—É –µ—Ç–∞–ø—ñ —ñ–≥–Ω–æ—Ä—É—î —Ñ–∞–π–ª–∏
  if ($chattype != 'private') {
    exit('ok');
    }

  // –Ø–∫—â–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ –æ—Å–æ–±–∏—Å—Ç—ñ
  // –Ø —Ü–µ–π —Ñ—É–Ω–∫—Ü—ñ—ñ–æ–Ω–∞–ª –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é, —Ç–æ–º—É –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–∑—Ä–æ–±–ª—è–≤

  $ua = "–ù–∞ –¥–∞–Ω–∏–π –º–æ–º–µ–Ω—Ç –±–æ—Ç –Ω–µ –∑–∞–ø–∏—Ç—É–≤–∞–≤ —É –í–∞—Å –Ω—ñ—è–∫–∏—Ö —Ñ–æ—Ç–æ –∞–±–æ —Å–∫—Ä—ñ–Ω—à–æ—Ç—ñ–≤, –∞ —Ç–æ–º—É —Ü–µ–π —Ñ–∞–π–ª –±—É–¥–µ –ø—Ä–æ—ñ–≥–Ω–æ—Ä–æ–≤–∞–Ω–æ.";
  $ru = "–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –±–æ—Ç –ù–ï –∑–∞–ø—Ä–∞—à–∏–≤–∞–ª —É –í–∞—Å –Ω–∏–∫–∞–∫–∏—Ö —Ñ–æ—Ç–æ –∏–ª–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤, –∞ –ø–æ—Ç–æ–º—É –¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω.";
  $en = "At the moment, the bot has NOT requested any photos or screenshots from you, and therefore this file will be ignored.";
  $response = mova::lg($lg, $ua, $ru, $en);
  $bot->reply($response);
  exit('end');

  }

// –Ø–∫—â–æ —é–∑–µ—Ä –Ω–∞—Ç–∏—Å–Ω—É–≤ –Ω–∞ –∫–Ω–æ–ø–∫—É
if ($callback_data) {
  // –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (—Ä–µ–∞–∫—Ü—ñ—é –Ω–∞ –∫–ª—ñ–∫) –±—É–¥–µ–º–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –≤ –æ—Å–æ–±–∏—Å—Ç—ñ
  $bot->for($user);
  // –¢–µ–∫—Å—Ç –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ñ–¥–º—ñ–Ω–∏ –¥—ñ—ó
  $ua = "–°–ö–ê–°–£–í–ê–ù–ù–Ø";
  $ru = "–û–¢–ú–ï–ù–ê";
  $en = "CANCEL";
  $regtextno = mova::lg($lg, $ua, $ru, $en);


  // ! –ü—ñ—Å–ª—è rear_btn 
  // –Ø–∫—â–æ —Ü–µ –∫–Ω–æ–ø–∫–∞ —è–∫–∞ –º—ñ—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É, —Ç–æ –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ –æ–±—Ä–æ–±–∫–∏ –∫–æ–º–∞–Ω–¥
  $firstChar = substr($callback_data, 0, 1);
  if ($firstChar == '/' and strlen($callback_data) > 2) {
    $text = $callback_data;

    goto skip;
    }


  // —É–º–æ–≤–Ω–æ –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏–π —Ñ—É–∫–Ω—Ü—ñ–æ–Ω–∞–ª, –∞–ª–µ —Ç—Ä–µ–±–∞ –ø—Ä–æ—Å—Ç–æ –≤–¥–æ—Å–∫–æ–Ω–∞–ª–∏—Ç–∏
  if (stristr($callback_data, 'btn_') !== false) {
    $cutt = mb_substr($callback_data, 4);
    // –î–ª—è —Ç–µ—Å—Ç–æ–≤
    //$bot->reply($cutt);exit('ok');

    // –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç–æ–º –∑–∞–ø—Ä–æ—à–µ–Ω –Ω–æ–≤—ã–π –∫–æ–¥ –ø—Ä–∏–≤—è–∑–∫–∏ - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –µ–≥–æ
    if ($cutt == 'newkod') {
      // –ò—â–µ–º –Ω–µ –ø–æ–ª—É—á–∞–ª –ª–∏ –∫–ª–∏–µ–Ω—Ç –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–Ω–µ–µ
      // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∂–∏–∑–Ω–∏ –∫–æ–¥–∞ –¥–æ–ø—É—Å—Ç–∏–º –°–£–¢–ö–ò
      $kp = tg::testKodProverki($bundle);

      if ($kp == false) {

        if ($bundle['trykod'] >= '1') {
          // –û–±–Ω—É–ª—è–µ–º –ø–æ–ø—ã—Ç–∫–∏
          core::$db->query("UPDATE `" . load::$tg_bundle . "` SET `trykod`= '0' WHERE `from_id`='" . $user . "' and `bot`='" . $botinfo['name'] . "'");
          }

        $ua = "–ù–∞–¥—Å–∏–ª–∞—î–º–æ email —ñ–∑ –∫–æ–¥–æ–º...";
        $ru = "–û—Ç–ø—Ä–∞–≤–ª—è–µ–º email —Å –∫–æ–¥–æ–º...";
        $en = "Send an email with the code...";
        $nowsendkod = mova::lg($lg, $ua, $ru, $en);
        $bot->answerCallback($nowsendkod);
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–∏—Å—å–º–æ —Å –∫–æ–¥–æ–º
        tg::SendKod($botinfo, $chat, $lg, $aco, $host, $isAdmin, $site, $infoemail);
        $bot->deleteMessage($message_id - 1);

        exit('ok');
        } else {
        $kogdanew = date('H:i (d.m.Y–≥.)', strtotime($bundle['kodtime']) + (60 * 60 * 24));
        // –î–æ–ø—É—Å—Ç–∏–º–æ –Ω–µ —Ä–∞–Ω—å—à–µ {kogdanew}
        $ua = "–î–æ–ø—É—Å—Ç–∏–º–æ –Ω–µ —Ä–∞–Ω—ñ—à–µ –Ω—ñ–∂ " . $kogdanew;
        $ru = "–î–æ–ø—É—Å—Ç–∏–º–æ –Ω–µ —Ä–∞–Ω—å—à–µ " . $kogdanew;
        $en = "Acceptable no earlier than " . $kogdanew;
        $ranowantkod = mova::lg($lg, $ua, $ru, $en);
        $bot->answerCallback($ranowantkod);

        }
      exit('ok');

      }


    if ($cutt == 'editemail') {
      // –ù—É–∂–Ω–æ –ø–æ–∑–≤–æ–ª—è—Ç—å –º–µ–Ω—è—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–π —ç–º–∞–∏–ª –Ω–µ —á–∞—â–µ —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü
      if ($bundle['kod'] == 'ok') {
        // –ê –≤ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π —Å—Ö–µ–º–µ –≤–æ–æ–±—â–µ –Ω–µ–ª—å–∑—è –ø–æ–∑–≤–æ–ª—è—Ç—å –µ–≥–æ –º–µ–Ω—è—Ç—å
        if ($st != 'credit') {
          $timepayt = strtotime($bundle['setmail']);
          $timeEnd = time() - (60 * 60 * 24 * 30);
          // –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ –º–µ–Ω—å—à–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ, —Ç–æ —Å—á–∏—Ç–∞–µ–º —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –∞–∫—Ç–∏–≤–Ω—ã–º
          if ($timepayt > $timeEnd) {
            $kogdanew = date('d.m.Y–≥.', strtotime($bundle['setmail']) + (60 * 60 * 24 * 30));
            // –î–æ–ø—É—Å—Ç–∏–º–æ –Ω–µ —Ä–∞–Ω—å—à–µ {kogdanew}
            $ua = "–î–æ–ø—É—Å—Ç–∏–º–æ –Ω–µ —Ä–∞–Ω—ñ—à–µ –Ω—ñ–∂ " . $kogdanew;
            $ru = "–î–æ–ø—É—Å—Ç–∏–º–æ –Ω–µ —Ä–∞–Ω—å—à–µ " . $kogdanew;
            $en = "Acceptable no earlier than " . $kogdanew;
            $ranowantkod = mova::lg($lg, $ua, $ru, $en);
            $bot->answerCallback($ranowantkod);

            $ua = "–ó –º–µ—Ç–æ—é –±–µ–∑–ø–µ–∫–∏ –º–∏ –¥–æ–∑–≤–æ–ª—è—î–º–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏–π email –ù–ï —á–∞—Å—Ç—ñ—à–µ —Ä–∞–∑—É –Ω–∞ –º—ñ—Å—è—Ü—å.\r\n\r\n–ó–º—ñ–Ω–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π email –í–∏ –∑–º–æ–∂–µ—Ç–µ –Ω–µ —Ä–∞–Ω—ñ—à–µ " . $kogdanew;
            $ru = "–í —Ü–µ–ª—è—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º—ã –ø–æ–∑–≤–æ–ª—è–µ–º –º–µ–Ω—è—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–π email –ù–ï —á–∞—â–µ —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü.\r\n\r\n–ò–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π email –í—ã —Å–º–æ–∂–µ—Ç–µ –Ω–µ —Ä–∞–Ω—å—à–µ " . $kogdanew;
            $en = "For security reasons, we allow you to change your confirmed email NOT more than once a month.\r\n\r\nYou can change your current email no earlier than " . $kogdanew;
            $textsTwo = mova::lg($lg, $ua, $ru, $en);
            $bot->reply($textsTwo);
            exit('ok');
            }
          }
        }

      // –ü—Ä–æ—Å–∏–º –≤–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π —ç–º–∞–∏–ª
      $ua = "–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤–∏–π email";
      $ru = "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π email";
      $en = "Enter new email";
      $sendnewmail = mova::lg($lg, $ua, $ru, $en);
      $bot->answerCallback($sendnewmail);
      $bot->reply($sendnewmail);
      exit('ok');
      }

    // 
    if ($cutt == 'oldmail') {
      $ua = "–ó–∞–ª–∏—à–∏–ª–∏ –≤—Å–µ —è–∫ –±—É–ª–æ";
      $ru = "–û—Å—Ç–∞–≤–∏–ª–∏ –≤—Å—ë –∫–∞–∫ –±—ã–ª–æ";
      $en = "Everything was left as it was";
      $vsekakbilo = mova::lg($lg, $ua, $ru, $en);
      $bot->answerCallback($vsekakbilo);
      $bot->deleteMessage($message_id - 1);
      $bot->deleteMessage($message_id);
      exit('ok');
      }


    }



  // –í–∏–¥–∞–ª–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ —è–∫–æ–≥–æ –ø—Ä–∏–≤'—è–∑–∞–Ω–∞ —Ü—è –∫–Ω–æ–ø–∫–∞
  if (stristr($callback_data, 'delete_') !== false) {
    $essence = mb_substr($callback_data, 7);
    if (!empty($essence)) { // –Ø–∫—â–æ —î –¥–æ–ø.–ø–∞—Ä–∞–º–µ—Ç—Ä
      // –í—ñ–¥–º—ñ—á–∞—î–º–æ –≤ –±–∞–∑—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —è–∫ –≤–∏–¥–∞–ª–µ–Ω–µ
      tg::delDialog($user, $essence, $message_id);
      }
    // –ü–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ —É—Å–ø—ñ—Ö
    $bot->answerCallback('ok');
    // –í–∏–¥–∞–ª—è—î–º–æ
    $bot->deleteMessage($message_id);
    exit('ok');
    }






  // –Ø–∫—â–æ –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥ —Ö–æ—á–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –º—ñ—Å—Ç–æ, —è–∫–µ –¥–æ–¥–∞–≤ —Ä–∞–Ω—ñ—à–µ
  if (stristr($callback_data, 'citydel_') !== false and $bundle['role'] == 'service') {
    $bot->answerCallback('in developing');
    $bot->insertButton([["text" => "–ù–ê–ó–ê–î –í –ü–†–û–§–Ü–õ–¨", "callback_data" => "/profile"]]); // –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –Ω–∞–∑–∞–¥
    $bot->reply("–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ...");
    exit('ok');
    }

  // –Ø–∫—â–æ —Ü–µ –∫–Ω–æ–ø–∫–∞ –≤–∏–±–æ—Ä—É –∑ –±–∞–≥–∞—Ç—å–æ—Ö –ø—É–Ω–∫—Ç—ñ–≤
  if (stristr($callback_data, 'choose_') !== false) {
    $cutt = mb_substr($callback_data, 7);
    $arrc = explode("_", $cutt);
    // –í–∏–¥–∞–ª—è—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
    // –ø—ñ–¥ —á–∞—Å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–µ –≤–∏–¥–∞–ª—è—é
    $bot->deleteMessage($message_id);
    $bot->answerCallback('');
    $response = '';
    // –ö–ª—ñ–µ–Ω—Ç–∏ –º–æ–∂—É—Ç—å –∑–±–µ—Ä–µ–≥—Ç–∏ –≤ –±–∞–∑—É –ª–∏—à–µ –æ–¥–Ω–µ –º—ñ—Å—Ç–æ
    // –Ø–∫—â–æ –º—ñ—Å—Ç–æ –≤–∫–∞–∑–∞–Ω–æ —Ä–∞–Ω—ñ—à–µ, —á–∏ –¥–∞—î–º–æ –º–∏ –∑–º–æ–≥—É –π–æ–≥–æ –ª–µ–≥–∫–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏?
    // –¢—Ä–µ–±–∞ –¥–∞–≤–∞—Ç–∏
    // –ê –æ—Å—å –Ω–∞–¥–∞–≤–∞—á–∞ —Å–µ—Ä–≤—ñ—Å—É —Ç—Ä–µ–±–∞ —è–∫–æ—Å—å –æ–±–º–µ–∂—É–≤–∞—Ç–∏. –Ø–ö?
    // –ù–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥ –ø–æ–∫–∏ —â–æ –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ 7 –º—ñ—Å—Ç 
    // —â–æ–± –º–æ–∂–Ω–∞ –±—É–ª–æ —Ä–æ–∑–º—ñ—Å—Ç–∏—Ç–∏ –¥–æ–∑–≤–æ–ª–µ–Ω—É —Ç–µ–ª–µ–≥—Ä–∞–º–æ–º –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥—ñ–≤-–∫–Ω–æ–ø–æ–∫
    if ($bundle['role'] == 'service') {
      // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –º–æ–∂–µ –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥ –¥–æ–¥–∞—Ç–∏ —â–µ
      // –ë–æ –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥ –º–æ–∂–µ —ó—Ö –Ω–∞–¥–∞–≤–∞—Ç–∏ –≤ –∫—ñ–ª—å–∫–æ—Ö –Ω–∞—Å–µ–ª–µ–Ω–∏—Ö –ø—É–Ω–∫—Ç–∞—Ö
      // –†–∞—Ö—É—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ–¥–∞–Ω–∏—Ö —Ä–∞–Ω—ñ—à–µ
      $secis = explode(",", $service["city_id"]);
      $seci = array_map('trim', $secis);
      $coci = count($seci);
      $cocilimit = 7;

      // –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ –º—ñ—Å—Ç–∞ –¥–æ–¥–∞–Ω—ã —Ä–∞–Ω—ñ—à–µ —Ü–∏–º 
      $listCity = tg::getCities($seci);
      $onlyCity = tg::getOnlyCities($listCity);


      // –ü–û–ö–ò –©–û –î–û–ó–í–û–õ–Ø–Ñ–ú–û –õ–ò–®–ï 7 —â–æ–± –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–Ω–æ–ø–æ–∫ –±—É–ª–∞ –¥–æ–ø—É—Å—Ç–∏–º–∞ —Ç–µ–ª–µ–≥—Ä–∞–º–æ–º
      // –Ø–∫—â–æ –¥–æ–∑–≤–æ–ª—è—Ç–∏ –¥–æ–¥–∞–≤–∞—Ç–∏ –±—ñ–ª—å—à–µ 7, —Ç–æ —Ç—Ä–µ–±–∞ –≤—Å–µ —É—Å–∫–ª–∞–¥–Ω—é–≤–∞—Ç–∏...
      // –ê–ª–µ (!) –∫–æ–¥ –Ω–∏–∂—á–µ –≤–∂–µ –≤–º—ñ—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ 14 –∫–Ω–æ–ø–∫–∞–º–∏!
      // –ü–∏—Ç–∞–Ω–Ω—è –≤ —Ç–æ–º—É
      // —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–∞–≤–∞—Ç–∏ –Ω–∞–¥–∞–≤–∞—á–∞–º –ø–æ—Å–ª—É–≥ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –≤–µ–ª–∏–∫–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –º—ñ—Å—Ç?
      // –õ—ñ–º—ñ—Ç–∏ –≤—Å–µ —Ä—ñ–≤–Ω–æ —î –Ω–µ —Ç–µ —â–æ–± –≤–µ–ª–∏–∫–∏–º–∏ —ñ –æ–±–º–µ–∂–µ–Ω—ñ ~28 –º–æ–∂–ª–∏–≤–æ –∫—Ä–∞–π - 35
      // –ø—ñ—Å–ª—è —è–∫–∏—Ö –ø–æ—Ç—Ä—ñ–±–Ω–æ —è–∫–æ—Å—å –¥–æ–¥–∞—Ç–∫–æ–≤–æ –≥–æ—Ä–æ–¥–∏—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∏
      // –í —Ä–∞–º–∫–∞—Ö rear –∑–∞–¥–∞—á—ñ —Ç–æ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ
      if ($coci >= $cocilimit) {
        // –Ø–∫—â–æ –≤–∂–µ –¥–æ–¥–∞–Ω–æ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ, –ø—Ä–æ–ø–æ–Ω—É—î–º–æ —Å–ø–æ—á–∞—Ç–∫—É –≤–∏–¥–∞–ª–∏—Ç–∏ —è–∫–∏–π—Å—å –æ–¥–∏–Ω 

        $uspehAdd = "–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É!\r\n";
        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–Ω–æ–ø–æ–∫ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –º—ñ—Å—Ç
        tg::makeDelCityBtnService($listCity, $bot);
        $bot->reply($uspehAdd . "–í–∏ –¥–æ–¥–∞–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –º–æ–∂–ª–∏–≤—É (" . $cocilimit . ") –∫—ñ–ª—å–∫—ñ—Å—Ç—å –º—ñ—Å—Ç!\r\n–©–æ–± –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤–µ, –í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –í–ò–î–ê–õ–ò–¢–ò –æ–¥–Ω–µ –∑ –¥–æ–¥–∞–Ω–∏—Ö —Ä–∞–Ω—ñ—à–µ.\r\n\r\n–û–±–µ—Ä—ñ—Ç—å –ú–Ü–°–¢–û –Ø–ö–ï –í–ò–î–ê–õ–ò–¢–ò:");
        exit('ok');
        }


      } // $arrc[0] == 'region' and $bundle['role'] == 'service'
    // –ö–æ–¥ –≤–∏—â–µ –ì–û–¢–û–í–ò–ô –∞–ª–µ –Ω–µ —Ç–µ—Å—Ç–æ–≤–∞–Ω–∏–π
    // –í—ñ–Ω –Ω–µ –¥–∞—î –Ω–∞–¥–∞–≤–∞—á—É –ø–æ—Å–ª—É–≥ –¥–æ–¥–∞—Ç–∏ —â–µ –æ–¥–Ω–µ –º—ñ—Å—Ç–æ —è–∫—â–æ –≤—ñ–Ω –¥–æ—Å—è–≥ –ª—ñ–º—ñ—Ç—É
    $arr = [];
    $list = $arrc[0];
    $idReg = false;
    array_shift($arrc); // –í–∏–¥–∞–ª—è—î–º–æ –∑ –º–∞—Å–∏–≤–∞ –ø–µ—Ä—à–∏–π –µ–ª–µ–º–µ–Ω—Ç $arrc[0] 'region'/'city'

    if (empty($arrc[1]) and $list == 'region') {
      $region = core::getRegionById($arrc[0]);
      $response = "–í–∏ –æ–±—Ä–∞–ª–∏:\r\n*" . $region['region'] . "*\r\n\r\n";
      }
    // –Ø–∫—â–æ –†–ï–ì–Ü–û–ù –ª–∏—à–µ –æ–¥–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∞–±–æ —Ü–µ –º—ñ—Å—Ç–æ (-–∞)
    // –®—É–∫–∞—î–º–æ –º—ñ—Å—Ç–∞
    if ((empty($arrc[1]) and $list == 'region') or $list == 'city') {
      $idReg = $arrc[0];
      if ($list == 'city') {
        array_shift($arrc); // –í–∏–¥–∞–ª—è—î–º–æ —Ä–µ–≥—ñ–æ–Ω –∑ –ø–µ—Ä–µ–ª—ñ–∫—É –º—ñ—Å—Ç
        }
      $mista = core::getAllSatellite($idReg, $botinfo['country'], $listProblemRegion, $botinfo['FilterPrblmRegion']);
      if ($bundle['role'] == 'service') {
        $mista = core::array–°leaning($mista, $onlyCity, $locale, true);
        }

      if (!empty($mista)) {
        $i = 0;
        foreach ($mista as $value) {
          $i++;
          $arr[$i]['id'] = $i;
          $arr[$i]['name'] = $value;

          }
        // –Ø–∫—â–æ —Ü–µ –ø–æ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—é –±—É–≤ –ø–µ—Ä–µ–ª—ñ–∫ –º—ñ—Å—Ç
        // –ó–Ω–∞—á–∏—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –æ–±—Ä–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ –º—ñ—Å—Ç–æ
        // —Ç–æ –≤–∏–∫–∏–¥–∞—î–º–æ —ñ–∑ –º–∞—Å–∏–≤—É –≤—Å–µ —â–æ –≤—ñ–¥—Å—É—Ç–Ω–µ –≤ $arrc
        if ($list === 'city') {
          $arr = array_filter($arr, function ($item) use ($arrc) {
            return in_array($item['id'], $arrc);
            });
          }
        $list = 'city';
        } else if ($bundle['role'] == 'service') {
        // –Ø–∫—â–æ –º—ñ—Å—Ç –ù–ï –ª–∏—à–∏–ª–æ—Å—å –Ü –ü–†–ò –¶–¨–û–ú–£
        // —Ü–µ –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥
        // –¢–∞ –≤–æ–¥–Ω–æ—á–∞—Å –≤ —Ä–µ–≥—ñ–æ–Ω—ñ –¥–æ —Ü—å–æ—ó —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –±—É–ª–∏ –º—ñ—Å—Ç–∞
        // –ó–Ω–∞—á–∏—Ç—å –Ω–∞–¥–∞–≤–∞—á—É –ø–æ—Å–ª—É–≥ –≤ —Ü—å–æ–º—É —Ä–µ–≥—ñ–æ–Ω—ñ –≤–∂–µ –Ω–µ –∑–∞–ª–∏—à–∏–ª–æ—Å—å –º—ñ—Å—Ç —ñ –≤—ñ–Ω –≤–∂–µ –≤–∫–∞–∑–∞–≤ –≤—Å—ñ
        // –í —Ü—ñ–π –æ–±–ª–∞—Å—Ç—ñ (—Ä–µ–≥—ñ–æ–Ω–∏) –í–∏ –Ω–∞–¥–∞—î—Ç–µ –ø–æ—Å–ª—É–≥–∏ –≤ —É—Å—ñ—Ö –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –º—ñ—Å—Ç–∞—Ö


        }



      }


    // –Ø–∫—â–æ –æ–±–ª–∞—Å—Ç–µ–π –∫—ñ–ª—å–∫–∞
    if (!empty($arrc[1]) and $list == 'region') {
      // –Ø–∫—â–æ –û–ë'–Ñ–ö–¢–Ü–í –±–∞–≥–∞—Ç–æ, —Ç—Ä–µ–±–∞ —Ä–æ–∑–∫–ª–∞—Å—Ç–∏ —ó—Ö –Ω–∞ –∫–Ω–æ–ø–∫–∏ —ñ –∑–Ω–æ–≤ –∑–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ –æ–±—Ä–∞—Ç–∏ —Ä–µ–≥—ñ–æ–Ω
      // –§–æ—Ä–º—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–µ—Ä–µ–ª—ñ–∫ —Ü—ñ–ª—å–æ–≤–∏—Ö —Ä–µ–≥—ñ–æ–Ω—ñ–≤
      $ids = implode(',', $arrc);
      $query = "SELECT `id`,`region` FROM `regions` WHERE `id` IN ($ids)";
      $result = core::$db->query($query);
      // –û–±—Ä–æ–±–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
      if ($result->num_rows > 0) {
        $i = 0;
        while ($row = $result->fetch_assoc()) {
          $i++;
          $arr[$i]['id'] = $row['id'];
          $arr[$i]['name'] = $row['region'];
          }
        $result->close();
        } else {
        // –¢–∞–∫–æ–≥–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ –º–æ–∂–µ –±—É—Ç–∏
        $list = 'error';
        }
      }
    // * –ö–û–î –í–ò–©–ï –í –†–ê–ú–ö–ê–• choose_ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –≥–æ—Ç–æ–≤–∏–º

    //$bot->reply(print_r($idReg,true) . " ".count($arr)." ". $list." ". $arrc[0]);exit('ok');
    //
    // –Ø–∫—â–æ –í –û–ë–õ–ê–°–¢–Ü –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –ú–Ü–°–¢ –Ω–µ–º–∞—î (—Ç–æ–±—Ç–æ —Ü–µ —Å—Ç–æ–ª–∏—Ü—è –∞–±–æ –º–∞–ª–µ–Ω—å–∫–∏–π —Ä–µ–≥—ñ–æ–Ω)
    // –ê–±–æ –æ–±—Ä–∞–Ω–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ –º—ñ—Å—Ç–æ
    // –∑–Ω–∞—á–∏—Ç—å –º–∏ –∑—É–ø–∏–Ω—è—î–º–æ—Å—è —ñ —Ñ—ñ–∫—Å—É—î–º–æ —Ç–µ —â–æ —î
    if ((empty($arr) and $list == 'region') or (count($arr) == '1' and $list == 'city')) {
      if (empty($region)) {
        $region = core::getRegionById($idReg);
        }
      $editR = false;
      // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –±–∞–∑—ñ —è–∫—â–æ —Ä–µ–≥—ñ–æ–Ω –∑–º—ñ–Ω–µ–Ω–æ
      if ($bundle['role'] != 'service') {

        // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –ù–û–í–ò–ô —Ä–µ–≥—ñ–æ–Ω —Ç–∞ –≤–∏–¥–∞–ª—è—î–º–æ —Å—Ç–∞—Ä–µ –º—ñ—Å—Ç–æ –≤ –¥–∞–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É –æ–±–æ–≤'—è–∑–∫–æ–≤–æ
        if ($bundle['region'] != $region['region']) {
          $bundle['region'] = $region['region'];
          // –Ø–∫—â–æ –≤–∫–∞–∑—É—î—Ç—å—Å—è –º—ñ—Å—Ç–æ, —Ç–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –∫–æ—Ä–∏–≥—É—î–º–æ
          if ($list == 'city') {
            $bundle['city'] = $arr[$arrc[0]]['name'];
            } else {
            // –Ø–∫—â–æ –ø–æ–∫–∏ —â–æ –≤–∫–∞–∑—É—î—Ç—å—Å—è –æ–±–ª–∞—Å—Ç—å, —Ç–æ –æ–±–Ω—É–ª—é—î–º–æ –º—ñ—Å—Ç–æ
            $bundle['city'] = "";
            }
          $editR = true;
          } else if ($list == 'city' and $bundle['city'] != $arr[$arrc[0]]['name']) {
          $editR = true;

          }
        if ($editR == true) {
          core::$db->query("UPDATE " . load::$tg_bundle . " SET `region` = '{$region['region']}',`city` = '{$bundle['city']}' WHERE `id`='{$bundle['id']}'");
          }
        if (empty($bundle['phone'])) {
          $renewvk = "–≤–∫–∞–∑–∞—Ç–∏";
          $prba = "–ø—Ä–∏ –±–∞–∂–∞–Ω–Ω—ñ";
          $narazi = "";
          $actual = "";
          } else {
          // –ß–∏ —Ç—Ä–µ–±–∞ –≤–∑–∞–≥–∞–ª—ñ –¥–æ—Å–∏–ª–∞—Ç–∏ —Ü–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ–Ω–æ–≤–∏—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω?
          // –ù–µ –¥—É–º–∞—é, –≤–æ–Ω–æ –±—ñ–ª—å—à–µ –∑–∞–≤–∞–∂–∞—î, –∞–ª–µ –≤–∏–¥–∞–ª—è—Ç–∏  —á–∏ –ø–µ—Ä–µ–Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –º–µ–Ω—ñ –≤–ø–∞–¥–ª–æ
          // –¢–æ–º—É –≤–∏–º–∏–∫–∞—é –∑–º—ñ–Ω–Ω–æ—é. true - —è–∫—â–æ —Ç—Ä–µ–±–∞ —Å–ª–∞—Ç–∏
          $sendReTel = false;
          $renewvk = "–æ–Ω–æ–≤–∏—Ç–∏";
          $prba = "–ø—Ä–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ";
          $narazi = "\r\n\r\n–ù–∞—Ä–∞–∑—ñ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ " . $bundle['phone'];
          $actual = " –∞–∫—Ç—É–∞–ª—å–Ω–∏–π";
          }
        $bot->insertButton([["text" => "–í–ê–® –ü–†–û–§–Ü–õ–¨", "callback_data" => "/profile"]]);
        $bot->insertButton([["text" => "üÜò –¢–ï–†–ú–Ü–ù–û–í–û " . $botinfodop['service'], "callback_data" => "/sos"]]);
        $bot->insertButton([["text" => $gotostart, "callback_data" => "/start"]]); // –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –Ω–∞–∑–∞–¥
        $bot->reply("–†–µ–≥—ñ–æ–Ω –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ –æ–Ω–æ–≤–ª–µ–Ω–æ!");
        if (!empty($sendReTel)) {
          $bot->setupTypeKeyboard('keyboard');
          $bot->insertButton([["text" => $sharecontact, "request_contact" => true]]);
          $bot->reply("–¢–µ–ø–µ—Ä (" . $prba . ") –í–∏ –º–æ–∂–µ—Ç–µ " . $renewvk . " —Å–≤—ñ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É, —â–æ –ø—Ä–∏–≤'—è–∑–∞–Ω–æ –¥–æ —Ü—å–æ–≥–æ Telegram –∞–∫–∫–∞—É–Ω—Ç—É" . $narazi . ".");
          }
        exit('ok');

        } else {
        // –Ø–∫—â–æ –ø–µ—Ä–µ–¥ –Ω–∞–º–∏ –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥
        // $bundle['role'] == 'service'
        // –®—É–∫–∞—î–º–æ –Ω–∞–∑–≤—É –º—ñ—Å—Ç–∞
        if ($list == 'city') {
          $city = $arr[$arrc[0]]['name'];
          $cityId = $arr[$arrc[0]]['id'];
          $listCity[$arr[$arrc[0]]['id']] = ['city' => $city, 'region' => $region['region']];
          } else {
          $city = '';
          $cityId = false;
          }
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –Ω–µ –¥–æ–¥–∞–≤–∞–≤ –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥ —Ü–µ –º—ñ—Å—Ç–æ (–û–ë–õ–ê–°–¢–¨) —Ä–∞–Ω—ñ—à–µ
        $testCid = tg::findCityId($listCity, $region['region'], $city);

        $uspehAdd = "–ú—ñ—Å—Ç–æ —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–æ:\r\n" . $region['region'] . ", " . $city . "\r\n-----\r\n";
        // –î–æ–¥–∞—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –≤–∫–∞–∑–∞–Ω–∏–π –Ω–∞–¥–∞–≤–∞—á–µ–º —Å–µ—Ä–≤—ñ—Å—É –≤ –±–∞–∑—É
        $new_id = tg::insertCity($bundle['id'], $city, $region['region'], $aco);
        // –î–æ–¥–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –≤ –π–æ–≥–æ –ø–µ—Ä–µ–ª—ñ–∫  $service["city_id"].","
        $update_city_id = core::updateStringIds($service["city_id"], $new_id);
        if ($update_city_id[1] == true) { // –í–Ω–æ—Å–∏–º–æ –≤ –±–∞–∑—É
          core::$db->query("UPDATE `tg_service` SET `city_id` = '{$update_city_id[0]}'  WHERE `id`='{$service['id']}'");
          }
        // –ø—ñ—Å–ª—è —á–æ–≥–æ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ –¥–æ–¥–∞—Ç–∏ —â–µ
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –º–æ–∂–µ –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥ –¥–æ–¥–∞—Ç–∏ —â–µ
        // –ë–æ –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥ –º–æ–∂–µ —ó—Ö –Ω–∞–¥–∞–≤–∞—Ç–∏ –≤ –∫—ñ–ª—å–∫–æ—Ö –Ω–∞—Å–µ–ª–µ–Ω–∏—Ö –ø—É–Ω–∫—Ç–∞—Ö
        // –ü–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –ª—ñ–º—ñ—Ç—É
        if ($coci >= $cocilimit - 1) {
          // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–Ω–æ–ø–æ–∫ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –º—ñ—Å—Ç
          tg::makeDelCityBtnService($listCity, $bot);
          $bot->reply($uspehAdd . "–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É!\r\n–í–∏ –¥–æ–¥–∞–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –º–æ–∂–ª–∏–≤—É (" . $cocilimit . ") –∫—ñ–ª—å–∫—ñ—Å—Ç—å –º—ñ—Å—Ç!\r\n–©–æ–± –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤–µ, –í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –í–ò–î–ê–õ–ò–¢–ò –æ–¥–Ω–µ –∑ –¥–æ–¥–∞–Ω–∏—Ö —Ä–∞–Ω—ñ—à–µ.\r\n\r\n–û–±–µ—Ä—ñ—Ç—å –ú–Ü–°–¢–û –Ø–ö–ï –í–ò–î–ê–õ–ò–¢–ò:");
          exit('ok');
          }
        // –Ø–∫—â–æ —â–µ –º–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ —ñ–Ω—à—ñ –º—ñ—Å—Ç–∞
        $bot->insertButton([['text' => "–¥–æ–¥–∞—Ç–∏ –º—ñ—Å—Ç–æ –Ω–∞–¥–∞–Ω–Ω—è –ø–æ—Å–ª—É–≥", 'callback_data' => 'rear_pluscityservice']]);
        $bot->reply($uspehAdd . "–í–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ —â–µ " . $cocilimit - $coci - 1 . " –º—ñ—Å—Ç:");
        exit('ok');



        }
      }
    // –Ø–∫—â–æ —î–ª–µ–º–µ–Ω—Ç—ñ–≤ > 7, —Ç–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –±—É–¥–µ —É–∫–æ–º–ø–∞–∫—Ç–Ω–µ–Ω–∞
    if (count($arr) > 7) {
      if ($list == 'city') {
        $utockilk = "–ø–µ—Ä—à—ñ –±—É–∫–≤–∏ –ù–ê–°–ï–õ–ï–ù–û–ì–û –ü–£–ù–ö–¢–£";
        } else {
        $utockilk = "–Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –±—É–∫–≤–∏ –∑ —è–∫–∏—Ö –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –Ω–∞–∑–≤–∞ –û–ë–õ–ê–°–¢–Ü";
        }

      } else {
      if ($list == 'city') {
        $utockilk = "–ù–ê–°–ï–õ–ï–ù–ò–ô –ü–£–ù–ö–¢";
        } else {
        $utockilk = "–û–ë–õ–ê–°–¢–¨";
        }

      }


    // –•—Ç–æ –æ–±–∏—Ä–∞—î –∑ –º–∞—Å—Å–∏–≤—É?
    // –í –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ü—å–æ–≥–æ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å
    if ($bundle['role'] != 'service') {
      // –ó–≤–∏—á–∞–π–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á
      $response .= "–ê —Ç–µ–ø–µ—Ä –æ–±–µ—Ä—ñ—Ç—å " . $utockilk . " –í–∞—à–æ–≥–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–Ω—è";
      } else {
      // –ù–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥
      $response .= "–ê —Ç–µ–ø–µ—Ä –æ–±–µ—Ä—ñ—Ç—å " . $utockilk . " –¥–µ –í–∏ –≥–æ—Ç–æ–≤—ñ –Ω–∞–¥–∞–≤–∞—Ç–∏ –ø–æ—Å–ª—É–≥–∏ —Ñ—ñ–∑–∏—á–Ω–æ:";
      }

    // –Ø–∫—â–æ —î –º–∞—Å—Å–∏–≤, —Ñ–æ—Ä–º—É—î–º–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É –∑ –≤–∏–±–æ—Ä–æ–º
    if (!empty($arr)) {
      $keyboard = tg::makeAbcKeyboard($arr, $list, $idReg, $locale);
      $bot->insertKeyboard($keyboard);
      }
    // –Ø–∫—â–æ –ø–æ–º–∏–ª–∫–∞
    if ($list == 'error') {
      $response = "–ü–æ–º–∏–ª–∫–∞ –ø–æ—à—É–∫—É...";
      }

    if ($bundle['role'] != 'service') {
      $kuda = '/reg';
      } else {
      $kuda = 'rear_pluscityservice';
      }

    $bot->insertButton([["text" => 'üîô –î–û –°–ü–ò–°–ö–£ –û–ë–õ–ê–°–¢–ï–ô', "callback_data" => $kuda]]); // –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –Ω–∞–∑–∞–¥
    $bot->reply($response);
    exit('ok');

    } // choose_


  // –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–∞–∂–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫—É –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –æ–ø–∏—Å–∞–Ω–∞ –≤—ã—à–µ
  // –í—ã—Ö–æ–¥–∏–º –Ω–∏–∫–∞–∫ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–≤ –∫–ª–∏–∫
  // ! –ú–æ–∂–ª–∏–≤–æ –ø—Ä–æ —Ü–µ —Ç—Ä–µ–±–∞ –ø–æ–≤—ñ–¥–æ–º–ª—è—Ç–∏ –∞–¥–º—ñ–Ω–∞
  // ! –±–æ –≤–∏—Ö–æ–¥–∏—Ç—å, —â–æ –∫–ª—ñ–∫ –ø–æ —è–∫—ñ–π—Å—å –∫–Ω–æ–ø—Ü—ñ –Ω–µ –±—É–ª–æ –æ–ø—Ä–∞—Ü—å–æ–≤–∞–Ω–æ
  $bot->answerCallback('');
  exit('ok');

  } // –ö–û–ù–ï–¶ –û–ë–†–ê–ë–û–¢–ö–ò –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ INLINE –∫–Ω–æ–ø–∫–∏


skip:

// –ü–æ—á–∏–Ω–∞—î–º–æ –æ–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏ 
// —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î–º–æ –Ω–∞ –Ω–∏—Ö –≤ –æ—Å–æ–±–∏—Å—Ç—ñ
$textCommand = false;
$firstChar = substr($text, 0, 1);
if ($firstChar == '/' and strlen($text) > 2) {
  $textCommand = true;
  $bot->for($user);
  if (!empty($cqid) and $chattype != 'private') {
    $bot->answerCallback('Bot sent you a private message');
    } else {
    $bot->answerCallback('');
    }
  }



// —Ç—É—Ç –æ–ø—Ä–∞—Ü—å–æ–≤—É—î–º–æ –∫–æ–º–∞–Ω–¥–∏ —è–∫—ñ –≤ –ø—É–±–ª—ñ—á–Ω–æ–º—É —á–∞—Ç—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å –±–æ—Ç–∞–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —á–∞—Ç—É
if ($textCommand == true and strpos($text, '@') !== false) {
  $command = explode("@", $text);
  $text = $command[0];



  }





// –í–∏–≤–æ–¥–∏–º–æ –ø—Ä–æ—Ñ–∞–π–ª –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
// —Ü–µ —á–µ—Ä–Ω–µ—Ç–∫–∞ —è–∫–∞ –¥—É–∂–µ –ù–ï–î–û–†–û–ó–†–û–ë–õ–ï–ù–ê
// chatGPT –º–µ–Ω—ñ –Ω–µ –ø–æ–¥–æ–±–∞—î—Ç—å—Å—è —è–∫ —Ç—É—Ç —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –ø—Ä–æ—Ñ–∞–π–ª, –¥—É–∂–µ –Ω–µ –Ω–∞–≥–ª—è–¥–Ω–æ —Ç–∞ –Ω–µ–∑—Ä—É—á–Ω–æ —ñ —Ü–µ –ø—Ä–∏ —Ç–æ–º—É —â–æ –ø—Ä–æ—Ñ–∞–π–ª –ø–æ–∫–∏ –Ω–µ –≤–µ–ª–∏–∫–∏–π —ñ –ø–æ–∫–∏ –ª–∏—à–µ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é. –°—Ç—Ä–∞—à–Ω–æ —É—è–≤–∏—Ç–∏ —è–∫–∞ —Ç—É—Ç –±—É–¥–µ –ø—Ä–æ—Å—Ç–∏–Ω—è –∫–æ–ª–∏ –ø—Ä–æ—Ñ–∞–π–ª –∑–±—ñ–ª—å—à–∏—Ç—å—Å—è, —Ç–æ–∂ —Ç—Ä–µ–±–∞ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –≤–∂–µ
if ($textCommand == true and $text === '/profile') {

  if ($bundle['region'] != '') {
    $regionv = "\r\n" . $bundle['region'];
    if ($bundle['city'] != '') {
      $regionv .= "\r\n" . $bundle['city'];
      }
    } else {
    $regionv = " _–©–ï –ù–ï –í–ö–ê–ó–ê–ù–û_";
    }
  if ($bundle['phone'] != '') {
    $phonev = $bundle['phone'];
    $edph = "–∑–º—ñ–Ω–∏—Ç–∏";
    } else {
    $edph = "–≤–∫–∞–∑–∞—Ç–∏";
    $phonev = "_–©–ï –ù–ï –ü–Ü–î–¢–í–ï–†–î–ñ–ï–ù–û_";
    }
  if ($bundle['dopphone'] != '') {
    $dopphonev = $bundle['dopphone'];
    $eddopph = "–∑–º—ñ–Ω–∏—Ç–∏";
    } else {
    $dopphonev = "_–©–ï –ù–ï –í–ö–ê–ó–ê–ù–û_";
    $eddopph = "–≤–∫–∞–∑–∞—Ç–∏";
    }
  $sprob = "0";
  $response = "";
  // –ü–µ—Ä—à–∞ –∫–Ω–æ–ø–∫–∞
  $bot->insertButton([['text' => $edph . " –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É", 'callback_data' => 'rear_editphone']]);

  $response .= "üì± –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞: " . $phonev . "\r\n---------\r\n";
  if ($bundle['role'] == '' or $bundle['role'] == 'candidate') {
    $response .= "üè† –ú—ñ—Å—Ç–æ –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è:" . $regionv . "\r\n---------\r\n";
    $response .= "üÜò –ó–∞–º–æ–≤–ª–µ–Ω—å " . $botinfodop['service'] . ": " . $sprob;
    }
  if ($bundle['role'] == 'candidate') {
    $bot->insertButton([['text' => "—Å–∫–∞—Å—É–≤–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞", 'callback_data' => 'rear_addserviceno']]);
    $response .= "\r\n---------\r\n–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É —è–∫–æ—Å—Ç—ñ " . $botinfodop['service'] . ":\r\n_–ö–ê–ù–î–ò–î–ê–¢_";
    }
    // –Ø–∫—â–æ —Ü–µ –Ω–∞–¥–∞–≤–∞—á –ø–æ—Å–ª—É–≥
  if ($bundle['role'] == 'service') {

    // –®—É–∫–∞—î–º–æ —Å–∫—ñ–ª—å–∫–∏ –º—ñ—Å—Ç –≤—ñ–Ω –¥–æ–¥–∞–≤ —Ä–∞–Ω—ñ—à–µ
    if (!empty($service['city_id'])) {
      $howcity = substr_count($service['city_id'], ',') + 1;
      } else {
      $howcity = 0;
      }
    // –í–∏–≤–æ–¥–∏–º–æ –ø–µ—Ä–µ–ª—ñ–∫ –¥–æ–¥–∞–Ω–∏—Ö —Ä–∞–Ω—ñ—à–µ —è–∫—â–æ –≤–æ–Ω–∏ —î
    if ($howcity >= 1) {
      $query = "SELECT * FROM `service_city` WHERE id IN (" . $service['city_id'] . ")";
      $result = core::$db->query($query);
      $listCityService = [];
      $lcs = "";
      while ($row = $result->fetch_assoc()) {
        $arrCityService[$row['id']] = $row;
        $lcs .= $row['city'] . ", " . $row['region'] . "\r\n";
        }
      $kiko = 7 - $howcity;
      $response .= "*–ú—ñ—Å—Ç–∞ –≤ —è–∫–∏—Ö –≤–∏ –ø—Ä–∞—Ü—é—î—Ç–µ:*\r\n" . $lcs . "\r\n---------\r\n";
      } else {
      $response .= "–í–∏ —â–µ –Ω–µ –≤–∫–∞–∑–∞–ª–∏ –∂–æ–¥–Ω–æ–≥–æ –º—ñ—Å—Ç–∞, —è–∫–µ –º–æ–∂–µ—Ç–µ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞—Ç–∏!\r\n---------\r\n";
      }
    // –ú–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –º–∏ –π–æ–≥–æ –≤–Ω–µ—Å–ª–∏ —è–∫ –∞–¥–≤–æ–∫–∞—Ç–∞
    if (!empty($service)) {
      if ($kiko >= 1 and $kiko <= 6) {
        $response .= "–í–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ —â–µ *" . $kiko . "* –º—ñ—Å—Ç\r\n---------\r\n";
        $bot->insertButton([['text' => "–¥–æ–¥–∞—Ç–∏ –º—ñ—Å—Ç–æ –Ω–∞–¥–∞–Ω–Ω—è –ø–æ—Å–ª—É–≥", 'callback_data' => 'rear_pluscityservice']]);
        }
      if ($howcity >= 7) {
        $response .= "–í–∏ –¥–æ–¥–∞–ª–∏ –º–∞–∫—Å–∏–º—É–º –º—ñ—Å—Ç!\r\n---------\r\n";
        }
      if ($howcity >= 1) {
        $bot->insertButton([['text' => "–≤–∏–¥–∞–ª–∏—Ç–∏ –º—ñ—Å—Ç–æ –Ω–∞–¥–∞–Ω–Ω—è –ø–æ—Å–ª—É–≥", 'callback_data' => 'citydel_list']]);
        }
      }

    $response .= "–£—Å–ø—ñ—à–Ω–æ –æ–ø—Ä–∞—Ü—å–æ–≤–∞–Ω–æ –∑–∞–º–æ–≤–ª–µ–Ω—å: *0*"; // –ü–æ–∫–∏ —â–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–º–æ–≤–ª–µ–Ω—å –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ
    } else {
    $bot->insertButton([['text' => "–∑–º—ñ–Ω–∏—Ç–∏ —Ä–µ–≥—ñ–æ–Ω –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è", 'callback_data' => 'rear_editregion']]);
    }
  $bot->insertButton([["text" => $gotostart, "callback_data" => "/start"]]); // –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –Ω–∞–∑–∞–¥
  $bot->reply($response);
  exit('ok');

  }





// –¢—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –º–∏ 
// –ø–æ—à—É–∫–∞–ª–∏ –∫–ª—ñ—î–Ω—Ç–∞, –≤–Ω–µ—Å–ª–∏ –π–æ–≥–æ –≤ –±–∞–∑—É, –∞–±–æ –∑–∞–±–∞–Ω–∏–ª–∏
// –¢—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è –º–∏ –ø–æ—á–∏–Ω–∞—î–º–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –¥—ñ–ø–ª—ñ–Ω–∫–∞–º–∏ —Ç–∞ –∫–æ–º–∞–Ω–¥–∞–º–∏
// –ü—Ä–∞—Ü—é—î–º–æ –° –î–Ü–ü–õ–Ü–ù–ö–ê–ú–ò
if ($textCommand == true and strpos($text, ' ') !== false) {
  $command = explode(" ", $text);
  }

// –Ø–∫—â–æ —Ü–µ –ø–µ—Ä–≤—ñ—Å–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ 
// (–≤–∏–∫–æ—Ä–∏—Å—Ç–≤—É—î—Ç—å—Å—è –≤ —Å—Ö–µ–º–∞—Ö –¥–µ —Å–ø–æ—á–∞—Ç–∫—É —Å–∞–π—Ç –ø–æ—Ç—ñ–º –±–æ—Ç (event))
// –¢–æ–±—Ç–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∂–µ –≤ –±–∞–∑—ñ, –º–∏ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î–º–æ –π–æ–≥–æ –ø–æ –¥—ñ–ø–ª—ñ–Ω–∫—É
//  —ñ –∑–∞—Ä–∞–∑ –≤—ñ–Ω –¥—ñ–ª–∏—Ç—å—Å—è —Å–≤–æ—ó–º tg
if ($textCommand == true and $st != 'bot' and $command[0] === '/start' and !empty($command[1]) and strlen($command[1]) >= '35' and strlen($command[1]) <= '44') {

  // –ú–∏ –º–æ–∂–µ–º–æ —Ä–æ–∑–ø–æ–≤—Å—é–¥–∂—É–≤–∞—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ –≤–∏–¥—ñ–≤ –¥—ñ–ø–ª—ñ–Ω–∫—ñ–≤

  // –ü–µ—Ä—à–∏–π –¥–ª—è –µ–∫—Å–ø—Ä–µ—Å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º –∑ –ª–∏—Å—Ç–∞
  // –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –∞–¥–º—ñ–Ω –º–æ–∂–µ –≤ —Å–≤–æ—î–º—É tg —á–∞—Ç—ñ –∑ –±–æ—Ç–æ–º –≤–≤–µ—Å—Ç–∏ sendkey gmail@gmail.com
  // —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–æ, –∫–æ–ª–∏ –≤–∏ –Ω–∞ —è–∫–∏—Ö–æ—Å—å –∑—É—Å—Ç—Ä—ñ—á–∞—Ö –∫–ª—É–±—É —Ö–æ—á–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —á–∞—Ç –∫–ª—É–±—É 
  // —Ç–æ–±—Ç–æ —è–∫—â–æ –∫–ª—ñ—î–Ω—Ç –ø–µ—Ä–µ–π—à–æ–≤ –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º –∑ —Ç–∞–∫–æ–≥–æ –ª–∏—Å—Ç–∞, —Ç–æ –≤—ñ–Ω –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏–≤ –µ–º–∞—ó–ª —ñ chat_ia –æ–¥–Ω–æ—á–∞—Å–Ω–æ
  // key a
  // https://t.me/{$botinfo['name']}?start={$user_key}a{$country}

  // –î—Ä—É–≥–∏–π –¥–ª—è –±—ñ–ª–µ—Ç–µ—Ä–∞
  // –î–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ QR –∫–æ–¥–∞—Ö –∫–≤–∏—Ç–∫—ñ–≤ –¥–ª—è –≤—Ö–æ–¥—É –Ω–∞ —ñ–≤–µ–Ω—Ç–∏
  // https://t.me/{$botinfo['name']}?start={$user_key}b{$ivent}
  // tg://resolve?domain={$botinfo['name']}?start={$user_key}c{$lg}

  // –¢—Ä–µ—Ç—ñ–π key "c" –¥–ª—è –∑–≤'—è–∑–∫–∏ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–Ω—ñ—à–µ –≤–µ–± –∞–∫–∫–∞—É–Ω—Ç–∞ –∑ —Ç–µ–ª–µ–≥—Ä–∞–º –∞–∫–∫–∞—É–Ω—Ç–æ–º

  // * –¢—Ä–µ—Ç—ñ–π key "c" - –ï–î–ò–ù–ò–ô –ù–ê–†–ê–ó–Ü –ü–û–¢–†–Ü–ë–ù–ò–ô –§–£–ù–ö–¶–Ü–û–ù–ê–õ –ù–ê–î –Ø–ö–ò–ú –ü–†–ê–¶–Æ–Æ
  // –Ü–Ω—à—ñ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –±–∞–∑–æ–≤–æ —ñ —ó—Ö —Ç—Ä–µ–±–∞ —â–µ —Ä–æ–∑–≤–∏–≤–∞—Ç–∏

  $user_key = mb_substr($command[1], 0, 32); // –ü–µ—Ä—à—ñ 32 —Å–∏–º–≤–æ–ª–∏
  $typelink = mb_substr($command[1], 32, 1); // 33-–π —Å–∏–º–≤–æ–ª
  $co = mb_substr($command[1], 33); // –í—Å—ñ —ñ–Ω—à—ñ —Å–∏–º–≤–æ–ª–∏ –ø—ñ—Å–ª—è 33-–≥–æ

  if (!empty($co) and $typelink != 'b') {
    // –î–ª—è –ø–æ—á–∞—Ç–∫—É, —Ç—Ä–µ–±–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø—Ä–∞—Ü—é—î —Å–∞–π—Ç –∑ —Ü—ñ—î—é –∫—Ä–∞—ó–Ω–æ—é
    // –Ü —Ç—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–∫–æ–Ω–∞–≤—à–∏—Å—å, —â–æ –ø—Ä–∞—Ü—é—î - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∫—Ä–∞—ó–Ω—É
    // –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ

    $lg = $co;
    }

    $mdkey = md5($user_key);

  // –ê–¥–º—ñ–Ω –ù–ï –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ (–ø–æ–≥–∞—Å–∏—Ç–∏) –¥—ñ–ø–ª—ñ–Ω–∫–∏ —Ü–∏—Ö —Ç–∏–ø—ñ–≤
  if (($typelink == 'a' or $typelink == 'c') and ($isAdmin === true or $isUsher === true)) {
    $bot->reply("The link must be used by the client!");
    exit('ok');
    }

  // –û—Ç–∂–µ, —É –Ω–∞—Å —î –∫–ª—é—á –∑–∞ —è–∫–∏–º –º–∏ —à—É–∫–∞—î–º–æ –º–∏–ª–æ –≤ —Ç–∞–±–ª–∏—Ü—ñ –∑ –¥–∏–ø–ª—ñ–Ω–∫–∞–º–∏
  // –ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–∏–ø—É –¥–∏–ø–ª—ñ–Ω–∫–∞ - —à—É–∫–∞—î–º–æ —É —Ä—ñ–∑–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—è—Ö
  $tabledip = false;
  // –¶–µ–π –ª—ñ–Ω–∫ –µ–∫—Å–ø—Ä–µ—Å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –ø–æ —Å—Å–∏–ª—Ü—ñ –∑ –ª–∏—Å—Ç–∞
  if ($typelink == 'a') {
    $tabledip = "tg_deeplink";
    $where = "user_key";
    $endz = "";
    }
  // —Ü–µ –ª—ñ–Ω–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∫–≤–∏—Ç–∫–∞ –¥–ª—è –±—ñ–ª–µ—Ç–µ—Ä–∞ –Ω–∞ –≤—Ö–æ–¥—ñ –Ω–∞ —ñ–≤–µ–Ω—Ç–∏
// –¢—É—Ç –≤—Å–µ —è–∫–µ—Å—å —Å–´—Ä—ç –ø–æ–∫–∏ —â–æ
  else if ($typelink == 'b') {
    $tabledip = "tickets";
    $where = "key";
    $endz = "";
    // —Ç–µ—Å—Ç–æ–≤–µ
    $bot->reply('—Ç—ñ–∫–µ—Ç —É—Å–ø—ñ—à–Ω–æ –ø—Ä–æ—Å–∫–∞–Ω–æ–≤–∞–Ω–æ');
    exit('ok');
    }

  // 
  else if ($typelink == 'c') {
    $tabledip = load::$partners;
    $where = "partner_key";
    $endz = "";
    }

  // –ó–∞–≥–æ—Ç–æ–≤–æ—á–∫–∏ —Ç–∏–ø–æ–≤—ñ
// –ü—ñ–¥ –ø–æ–º–∏–ª–∫—É
  $ua = "–ü–æ—Å–∏–ª–∞–Ω–Ω—è —è–∫–∏–º –í–∏ —Å–∫–æ—Ä–∏—Å—Ç–∞–ª–∏—Å—è, –Ω—ñ –¥–æ —á–æ–≥–æ –Ω–µ –ø—Ä–∏–∑–≤–µ–ª–æ";
  $ru = "–°—Å—ã–ª–∫–∞, –∫–æ—Ç–æ—Ä–æ–π –í—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å, –Ω–∏ –∫ —á–µ–º—É –Ω–µ –ø—Ä–∏–≤–µ–ª–∞";
  $en = "The link you used did not lead to anything";
  $error_link = mova::lg($lg, $ua, $ru, $en);
  $ua = "–ó –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è–º!";
  $ru = "–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!";
  $en = "Welcome back!";
  $welcomeback = mova::lg($lg, $ua, $ru, $en);

  // –ü–µ—Ä–µ–¥ –Ω–∞–º–∏ –ø–æ–º–∏–ª–∫–æ–≤–∏–π –ª—ñ–Ω–∫
  if ($tabledip == false) {
    // –ü–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ –ø–æ–º–∏–ª–∫—É –ª—ñ–Ω–∫—É
    $bot->reply($error_link . ' #0');
    exit('ok');
    }


  $result = core::$db->query("SELECT * FROM `{$tabledip}` WHERE `{$where}`='{$mdkey}'{$endz}");
  $countsrows = $result->num_rows;
  if ($countsrows == 1) {
    // –û—Ç—Ä–∏–º—É—î–º–æ –º–∞—Å–∏–≤ —è–∫–∏–π –∑–Ω–∞–π—à–ª–∏ –ø–æ —Å—Å–∏–ª—Ü—ñ
    $searchdl = $result->fetch_array(MYSQLI_ASSOC);
    $result->close();
    } else if ($countsrows > 1) {
    $result->close();
    // –ü–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ –ø–æ–º–∏–ª–∫—É –ª—ñ–Ω–∫—É
    $bot->reply($error_link . ' #1');
    exit('ok');
    } else {
    $result->close();
    }

  // –Ø–∫—â–æ —Ü–µ –Ω—ñ–±–∏ –º–∞–≤ –±—É—Ç–∏ –∫–ª—ñ–µ–Ω—Ç, –∞ –π–æ–≥–æ –≤ –±–∞–∑—ñ –Ω–µ –∑–Ω–∞–π—à–ª–∏, –∑–Ω–∞—á–∏—Ç—å –ª—ñ–Ω–∫ –Ω–µ –≤—ñ—Ä–Ω–∏–π
  if (empty($searchdl) and $typelink == 'c') {
    // –ü–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –∫–ª—ñ–µ–Ω—Ç—É, —â–æ –º–∏ –π–æ–≥–æ –Ω–µ –∑–Ω–∞–π—à–ª–∏ –≤ –±–∞–∑—ñ —ñ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ —Å–ø–æ—á–∞—Ç–∫—É –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—å –Ω–∞ —Å–∞–π—Ç—ñ
    $bot->hello($textNeedRegSite);
    exit('hello');
    }





  // –ï—Å–ª–∏ –¥–∏–ø–ª–∏–Ω–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω, —Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ –æ–Ω —É–∂–µ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ä–∞–Ω–µ–µ
  if (empty($searchdl) and $typelink == 'a') {
    $tbs = tg::SearchTgByKey($mdkey, $nameBot);
    // –ê–∫–∫–∞—É–Ω—Ç —É–∂–µ —Å–æ–∑–¥–∞–≤–∞–ª—Å—è —Ä–∞–Ω–µ–µ
    if (!empty($tbs) and $tbs['kod'] = 'ok') {
      // –í–æ–∑–º–æ–∂–Ω–æ –∫–ª–∏–µ–Ω—Ç —É–¥–∞–ª–∏–ª –ø—Ä–∏–≤—è–∑–∫—É –∫ –±–æ—Ç—É, —Ç–æ–≥–¥–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –µ—ë
      if ($tbs['mst'] != '') {
        $bot->reply($welcomeback);
        core::$db->query("UPDATE `" . load::$tg_bundle . "` SET `mst` = '',`setmail`=NOW(),`trykod`= '0'`country`='{$lg}' WHERE `from_id`='{$chat}' AND `bot` = '{$nameBot}");
        exit('ok');
        }
      }
    // –ú–æ–∂–Ω–æ —É—Å–ª–æ–∂–Ω—è—Ç—å –∏ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å –ø—Ä–∏—á–∏–Ω—ã
    // –î–∞–≤–∞—Ç–∏ —è–∫—ñ—Å—å —Å–∫–ª–∞–¥–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –∞–ª–µ –ø–æ–∫–∏ —â–æ –≤–∏—Ö–æ–¥–∏–º–æ
    // –ü–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ –ø–æ–º–∏–ª–∫—É –ª—ñ–Ω–∫—É
    $bot->reply($error_link . ' #2');
    exit('ok');

    }




  // –í–ò–¥–∞—î–º–æ –ø–æ–º–∏–ª–∫—É –¥–ª—è —ñ–Ω—à–∏—Ö —Å–∏—Ç—É–∞—Ü—ñ–π –Ω–µ–Ω–∞—Ö–æ–¥—É
  if (empty($searchdl)) {
    // –ü–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ –ø–æ–º–∏–ª–∫—É –ª—ñ–Ω–∫—É
    $bot->reply($error_link . ' #3');
    exit('ok');
    }
  // –¥–∞–ª—ñ –ø—Ä–æ—Ö–æ–¥—è—Ç—å –ª–∏—à–µ —Ç—ñ –∫–æ–≥–æ –º–∏ –∑–Ω–∞–π—à–ª–∏ –≤ –±–∞–∑—ñ

// –ê –∑–Ω–∞—á –¥–∞–ª—ñ user_key –Ω–æ—Ä–º–∞–ª—å–Ω–æ –ø—Ä–∞—Ü—é—î
  array_push($billet, "{user_key}");
  array_push($repl, $user_key);


  // –û—Ç–∂–µ —Å–ø—Ä–æ–±–∞ —î–∫—Å–ø—Ä–µ—Å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
  // –¢—É—Ç –Ω—ñ–±–∏ —Ç—Ä–æ—Ö–∏ –∫–∞—à–∞
  // –ü—Ä–æ—à—É chatGPT –¥–æ–≤–µ—Å—Ç–∏ –¥–æ —Ä–æ–±–æ—á–æ–≥–æ —Å—Ç–∞–Ω—É —è–∫—â–æ —î –ø—Ä–æ–≥–∞–ª–∏–Ω–∏ –≤ –ª–æ–≥—ñ—Ü—ñ
  if ($typelink == 'a') {
    // –ü–æ–ª—É—á–∏–≤ –º—ã–ª–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–Ω–æ —é–∑–µ—Ä–∫–µ—é
    // –§–æ—Ä–º–∏—Ä—É–µ–º —é–∑–µ—Ä –∫–µ–π –∑–∞–Ω–æ–≤–æ?
    $semail = core::buildStandartEmail($searchdl['email']);
    $ukey = md5($semail . load::SECURITY);
    // –ï—Å–ª–∏ –∫–ª—é—á –≤–µ—Ä–Ω—ã–π, —Ç–æ –≤–Ω–æ—Å–∏–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –±–∞–∑—É
    if ($ukey == $user_key) {
      // –ü–æ–∏—â–µ–º –µ—Å—Ç—å –≤–æ–æ–±—â–µ –ª–∏ —Ç–∞–∫–æ–µ –º—ã–ª–æ –≤ —Å–≤—è–∑–∫–∞—Ö —Å —ç—Ç–∏–º –±–æ—Ç–æ–º
      // –ò–±–æ –º—ã–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è 
      $tgBundle = tg::SearchTgEmail($semail, $bot);
      if ($tgBundle and $tgBundle['from_id'] != $chat) {
        // –î–∞–Ω–Ω–æ–µ –º—ã–ª–æ —É–∂–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫–æ–º—É-—Ç–æ –¥—Ä—É–≥–æ–º—É, –ø—Ä–æ—Å–∏–º –¥—Ä—É–≥–æ–π –º–∞–∏–ª
        $ua = "–î–∞–Ω–∏–π email –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–∏–π –∑–∞ —ñ–Ω—à–∏–º Telegram –∞–∫–∞—É–Ω—Ç–æ–º.\r\n\r\n–î–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –ø—ñ–¥ —Ü–∏–º Telegram –∞–∫–∞—É–Ω—Ç–æ–º –í–∞–º –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—à–∏–π email.\r\n\r\n–í–≤–µ–¥—ñ—Ç—å –Ω–∏–∂—á–µ —ñ–Ω—à–∏–π email:";
        $ru = "–î–∞–Ω–Ω—ã–π email –∑–∞–∫—Ä–µ–ø–ª—ë–Ω –∑–∞ –¥—Ä—É–≥–∏–º Telegram –∞–∫–∫–∞—É–Ω—Ç–æ–º.\r\n\r\n–î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–¥ —ç—Ç–∏–º Telegram –∞–∫–∫–∞—É–Ω—Ç–æ–º –í–∞–º –ø—Ä–∏–¥—ë—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π email.\r\n\r\n–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∂–µ –¥—Ä—É–≥–æ–π email:";
        $en = "This email is assigned to another Telegram account.\r\n\r\nTo register under this Telegram account you will have to use another email.\r\n\r\nEnter another email below:";
        $texts = mova::lg($lg, $ua, $ru, $en);
        $bot->reply($texts);
        exit('ok');
        }

      $uktb = md5($user_key);
      $ua = "–í–∏ —É—Å–ø—ñ—à–Ω–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω—ñ! –ü—Ä–∏—î–º–Ω–æ—ó —Ä–æ–±–æ—Ç–∏!";
      $ru = "–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã! –ü—Ä–∏—è—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã!";
      $en = "You are successfully registered! Have a nice job!";
      $answerOkReg = mova::lg($lg, $ua, $ru, $en);
      $bot->reply($answerOkReg);
      if (!empty($bundle['from_id'])) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å
        $stz = "UPDATE";
        $endz = "WHERE `from_id`='" . $bundle['from_id'] . "' and `bot`='" . $bot . "'";
        } else {
        // –í—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
        $stz = "INSERT INTO";
        $endz = "";
        }
      core::$db->query($stz . " `" . load::$tg_bundle . "` SET  `email`='$semail',`user_key`='$uktb',`kod`='ok',`setmail`=NOW(),`trykod`= '0',`country` = '$lg'" . $endz);
      // –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å—å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —Å –¥–∏–ø–ª–∏–Ω–∫–∞–º–∏
      core::$db->query("DELETE FROM `" . load::$tg_deeplink . "` WHERE `email` = '" . $semail . "'");
      exit('ok');
      }
    }

  // –í —Å–≤–æ—é —á–µ—Ä–≥—É –∫–ª—ñ–µ–Ω—Ç –Ω–µ –º–æ–∂–µ –ø–æ–≥–∞—Å–∏—Ç–∏ –¥—ñ–ø–ª—ñ–Ω–∫ –∫–ª–∞—Å—É b
  if ($typelink == 'b' and $isAdmin === false and $isUsher === false) {
    // –ó–∞–≥–∞–ª–æ–º —Ç—É—Ç —Ç—Ä–µ–±–∞ –≤—Å–µ —Å–∏–ª—å–Ω–æ —É—Å–∫–ª–∞–¥–Ω–∏—Ç–∏
// –Ø–∫—â–æ –∫–≤–∏—Ç–æ–∫ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤—ñ–¥—Å–∫–∞–Ω–∏—Ç–∏ —Å–∞–º –≤–æ–ª–æ–¥–∞—Ä –∫–≤–∏—Ç–∫–∞, —Ç–æ 
// –π–æ–º—É –º–æ–∂–Ω–∞ –ø–∏—Å–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–æ–¥—ñ—é (–¥–∞—Ç—É, —á–∞—Å, –º—ñ—Å—Ü–µ, —Ü—ñ–Ω—É)

    // –Ø–∫—â–æ –∫–≤–∏—Ç–æ–∫ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤—ñ–¥—Å–∫–∞–Ω–∏—Ç–∏ –ù–ï –≤–æ–ª–æ–¥–∞—Ä –∫–≤–∏—Ç–∫–∞ —ñ –≤–∏—Ö–æ–¥–∏—Ç—å (–Ω–µ –Ω–∞—à—ñ –∞–¥–º—ñ–Ω–∏ —Ç–∞ isUsher)
// –ô–æ–º—É –≤–∏–¥–∞–≤–∞—Ç–∏ —è–∫—É—Å—å –≤—ñ–¥–º–æ–≤—É


    // –ê –¢–ê–ö–û–ñ –≤–æ–ª–æ–¥–∞—Ä—é –≤–∏—Å–∏–ª–∞—Ç–∏ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è –ø—Ä–æ —Ç–µ, —â–æ –Ω–µ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –∫–≤–∏—Ç–æ–∫ —Ç—Ä–µ—Ç—ñ–º –æ—Å–æ–±–∞–º




    }



  // –û—Ç–∂–µ, –∞–¥–º—ñ–Ω –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫–≤–∏—Ç–æ–∫
  if ($typelink == 'b' and $isAdmin === true) {


    // –ê–¥–º—ñ–Ω—É –ø–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ 
// –¥–æ–∑–≤—ñ–ª –Ω–∞ –≤—Ö—ñ–¥ —è–∫—â–æ –≤—Å–µ –æ–∫

    // –ê–¥–º—ñ–Ω—É –ø–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ 
// –°–ø—Ä–æ–±—É –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–≤–∏—Ç–∫–∞

    // –ê–¥–º—ñ–Ω—É –ø–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ 
// –ü–æ–º–∏–ª–∫—É (–Ω–µ–¥—ñ–π—Å–Ω–∏–π –∫–≤–∏—Ç–æ–∫ —á–∏ —Å—Å–∏–ª–∫–∞)

    // –ö–ª—ñ–µ–Ω—Ç—É –ø–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ
// –£—Å–ø—ñ—à–Ω–∏–π –¥–æ–ø—É—Å–∫
    $ua = "–î—è–∫—É—î–º–æ! –õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ!";
    $ru = "–°–ø–∞—Å–∏–±–æ! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!";
    $en = "Thank you! Welcome!";

    $responseClient = mova::lg($lg, $ua, $ru, $en);
    $textsClient = str_replace($billet, $repl, $responseClient);

    $responseAdmin = mova::lg($lg, $ua, $ru, $en);
    $textsAdmin = str_replace($billet, $repl, $responseAdmin);
    // –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î–º–æ –∞–¥–º—ñ–Ω—É
    $bot->reply($textsAdmin);
    // –õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º –∫–ª—ñ–µ–Ω—Ç–∞
//$bot->for();$bot->reply($textsClient);

    //
    exit('ok');
    }

  // –ö–ª—ñ–µ–Ω—Ç –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–∏—Ç–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é
  if ($typelink == 'c') {
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–º —Ü–µ 
    // –ù—É —Ç–æ–±—Ç–æ —á–∏ –Ω–µ —Ä–æ–±–∏–≤ –≤—ñ–Ω —Ü–µ —Ä–∞–Ω—ñ—à–µ
    if ($searchdl['TelegaID'] == '') {

      $testsear = false;
      $tomach = false;
      $tsm = mova::lg($lg, "—ñ–Ω—à–æ–≥–æ email", "–¥—Ä—É–≥–æ–º—É email", "another email");
      // –®—É–∫–∞—î–º–æ, –∞ —á–∏ –Ω–µ –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–æ —Ü–µ–π —Ç–µ–ª–µ–≥—Ä–∞–º –∞–∫–∫–∞—É–Ω—Ç –Ω–∞—Ä–∞–∑—ñ –∑–∞ –∫–∏–º–æ—Å—å —ñ–Ω—à–∏–º?
      $result = core::$db->query("SELECT * FROM `" . load::$partners . "` WHERE `TelegaID`='" . $user . "'");
      $stroki = $result->num_rows;
      if ($stroki == 0) {
        $result->close();
        }
      // –¶–µ —è–∫–∞—Å—å –ø–æ–≥–∞–Ω–∞ —Å–∏—Ç—É–∞—Ü—ñ—è
      if ($stroki > 1) {
        $result->close();
        $tomach = true;
        }

      if ($stroki == 1) {
        $testsear = $result->fetch_array(MYSQLI_ASSOC);
        $result->close();
        $tsm = $testsear['email'];
        }

      // –ì–æ—Ç—É—î–º–æ —Ç–µ–∫—Å—Ç –ø–æ–º–∏–ª–∫–∏
      $ua = "–í–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—å –ø—Ä–∏–≤'—è–∑–∞—Ç–∏ —Ü–µ–π —Ç–µ–ª–µ–≥—Ä–∞–º –¥–æ " . $searchdl['email'] . "\r\n\r\n–ê–ª–µ —Ü–µ –ù–ï–ú–û–ñ–õ–ò–í–û –±–æ —Ü–µ–π —Ç–µ–ª–µ–≥—Ä–∞–º –≤–∂–µ –ø—Ä–∏–≤'—è–∑–∞–Ω–æ –¥–æ " . $tsm . "\r\n\r\n–ó–≥—ñ–¥–Ω–æ –Ω–∞—à—ñ—Ö –ø–æ–ª—ñ—Ç–∏–∫ - –º–∏ –Ω–µ –º–æ–∂–µ–º–æ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –ø—Ä–∏–≤'—è–∑–∞—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –¥–æ –æ–¥–Ω–æ–≥–æ —Ç–µ–ª–µ–≥—Ä–∞–º –∞–∫–∞—É–Ω—Ç—É.\r\n\r\n–û–¥–Ω–∞ –ª—é–¥–∏–Ω–∞ –º–æ–∂–µ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –ª–∏—à–µ –æ–¥–∏–Ω –æ—Å–æ–±–∏—Å—Ç–∏–π –∞–∫–∞—É–Ω—Ç.";
      $ru = "–≠—Ç–æ—Ç —Ç–µ–ª–µ–≥—Ä–∞–º –ø—Ä–∏–≤—è–∑–∞–Ω –∫ " . $tsm . "\r\n\r\n–°–æ–≥–ª–∞—Å–Ω–æ –Ω–∞—à–∏–º –ø–æ–ª–∏—Ç–∏–∫–∞–º ‚Äì –º—ã –Ω–µ –º–æ–∂–µ–º –ø–æ–∑–≤–æ–ª–∏—Ç—å –ø—Ä–∏–≤—è–∑–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∫ –æ–¥–Ω–æ–º—É —Ç–µ–ª–µ–≥—Ä–∞–º–º –∞–∫–∫–∞—É–Ω—Ç—É.\r\n\r\n–û–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫ –º–æ–∂–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ª–∏—á–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç.";
      $en = "This telegram is linked to " . $tsm . "\r\n\r\nDue to our policies, we cannot allow several cloud accounts to be linked to one telegram account.\r\n\r\nOne person can register only one specific account.";
      $response = mova::lg($lg, $ua, $ru, $en);


      // –Ø–∫—â–æ –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–∏–π, –ø–µ—Ä–µ–≤—ñ—Ä–∏–º–æ, —á–∏ –Ω–µ –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–∏–π –≤—ñ–Ω –∑–∞ —Ç–∏–º –∫–æ–≥–æ –º–∏ –∑–∞–±–∞–Ω–∏–ª–∏
      if (!empty($testsear) or $tomach == true) {
        // –Ø–∫—â–æ –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–∏–π –∑–∞ —Ç–∏–º –∫–æ–≥–æ –º–∏ –∑–∞–±–∞–Ω–∏–ª–∏ —Ä–∞–Ω—ñ—à–µ, —Ç–æ 
        // –∑–Ω–∞—á–∏—Ç—å –±–∞–Ω–∏–º–æ –π —Ü–µ–π –Ω–æ–≤–æ—Å—Ç–≤–æ—Ä–µ–Ω–∏–π –∞–∫–∫–∞—É–Ω—Ç
        if (!empty($testsear) and $testsear['status'] == 'black') {

          }

        // –Ø–∫—â–æ –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–∏–π, –Ω–æ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π, —Ç–æ –≤–∏–¥–∞—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —â–æ —Ü–µ–π –∞–∫–∫–∞—É–Ω—Ç –≤–∂–µ –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π –¥–æ —ñ–Ω—à–æ–≥–æ
        $bot->reply($response);
        exit('ok');
        }



      $ua = "–í—ñ—Ç–∞—î–º–æ!\r\n\r\n–¢–µ–ø–µ—Ä –í–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É.\r\n\r\n–ú–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—å, —â–æ —Ç–µ–ª–µ—Ñ–æ–Ω " . $searchdl['phone'] . " –≤–∫–∞–∑–∞–Ω–∏–π –í–∞–º–∏ –ø—Ä–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó, –ø—Ä–∏–≤'—è–∑–∞–Ω–æ —Å–∞–º–µ –¥–æ —Ü—å–æ–≥–æ —Ç–µ–ª–µ–≥—Ä–∞–º –∞–∫–∫–∞—É–Ω—Ç—É.\r\n\r\n–í–æ–¥–Ω–æ—á–∞—Å, —Ü–µ –ø—Ä–æ—Å—Ç–∏–π —Å–ø–æ—Å—ñ–± –≤–µ—Ä–µ—Ñ—ñ–∫–∞—Ü—ñ—ó –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—É –±–µ–∑ –¥–∑–≤—ñ–Ω–∫—ñ–≤ —Ç–∞ –°–ú–°.";
      $ru = "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º! –¢–µ–ø–µ—Ä—å –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞. –ú—ã –¥–æ–ª–∂–Ω—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–µ–ª–µ—Ñ–æ–Ω " . $searchdl['phone'] . " —É–∫–∞–∑–∞–Ω–Ω—ã–π –í–∞–º–∏ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, —Å–≤—è–∑–∞–Ω –∏–º–µ–Ω–Ω–æ —Å —Ç–µ–∫—É—â–∏–º —Ç–µ–ª–µ–≥—Ä–∞–º–º –∞–∫–∫–∞—É–Ω—Ç–æ–º.\r\n\r\–¢–∞–∫–∂–µ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –±–µ–∑ –∑–≤–æ–Ω–∫–æ–≤ –∏ –°–ú–°.";
      $en = "Hi!\r\n\r\nNow you need to confirm the phone number.\r\n\r\nWe need to make sure that phone " . $searchdl['phone'] . " specified by you during registration is connected to the current Telegram account.\r\n\r\nAt the same time, this is a simple way to verify the phone number without calls and SMS.";
      $response = mova::lg($lg, $ua, $ru, $en);


      $timestamp = date('Y-m-d H:i:s');
      // –ù–µ –¥—É–±–ª—é–≤–∞—Ç–∏ —Ü–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–∞—Å—Ç—ñ—à–µ –Ω—ñ–∂ —Ä–∞–∑ –Ω–∞ 3 —Ö–≤–∏–ª–∏–Ω
      $bot->insertButton([['text' => $sharecontact, 'request_contact' => true]]);
      $bot->setupTypeKeyboard('keyboard');
      $bot->setHoldMinutes(3);
      $bot->giveLogName('authstart');
      $bot->reply($response);

      // –ó–∞–ø–∏—Å—É—î–º–æ –∑–≤'—è–∑–æ–∫ —Ü—å–æ–≥–æ –º–∏–ª–∞ –∑ —Ü–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º
      // –¢–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î–º–æ –º–∏–ª–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ, –±–æ –∫–ª—ñ–µ–Ω—Ç –π–æ–≥–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏–≤ –Ω–∞ –º–∏–Ω—É–ª–æ–º—É –∫—Ä–æ—Ü—ñ
      core::$db->query("UPDATE `" . load::$tg_bundle . "` SET `email`='{$searchdl['email']}',`country`= '{$searchdl['country']}',`kod`='ok' WHERE `from_id`='{$user}' AND `bot`='{$nameBot}'");

      exit('ok');




      } else {
      $bot->reply($welcomeback);
      }

    exit('ok');
    }




  // –Ø–∫—â–æ –º–∏ —á–æ–º—É—Å—å –ù–ï –æ–±—Ä–æ–±–∏–ª–∏ –¥—ñ–ø–ª—ñ–Ω–∫—É, —Ç–æ —Ç—É—Ç –≤–∫—ñ–Ω—Ü—ñ
  // –ü–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –ø—Ä–æ –ø–æ–º–∏–ª–∫—É –ª—ñ–Ω–∫—É —ñ –≤–∏—Ö–æ–¥–∏–º–æ
  $bot->reply($error_link . ' #99');
  exit('ok');


  }


// –ó–ê–ö–Ü–ù–ß–ò–õ–ò –ó –ö–û–ú–ê–ù–î–ê–ú–ò


// !–Ø–∫—â–æ —Ü–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –∫–∞–Ω–∞–ª—É –∞–±–æ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ —á–∞—Ç—É, —Ç–æ –±–æ—Ç –¥–∞–ª—ñ –ù–ï –π–¥–µ
// ! –î–∞–ª—ñ –õ–ò–®–ï –û–°–û–ë–ò–°–¢–ê –ü–ï–†–ï–ü–ò–°–ö–ê –ó –ë–û–¢–û–ú
if ($chat != 'private') {
  exit('ok');
  }

// –û–¥—Ä–∞–∑—É –Ω–∞–ø–µ—Ä–µ–¥ –∑–∞–¥–∞—î–º–æ, —â–æ —Å–ø—ñ–ª–∫—É—î–º–æ—Å—è –≤ –æ—Å–æ–±–∏—Å—Ç–æ–º—É —á–∞—Ç—ñ –∑ —é–∑–µ—Ä–æ–º
$bot->for($user);

// –Ø–∫—â–æ —Ü–µ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
// –ú–∞–±—É—Ç—å –≤—ñ–Ω –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –≤—Ä—É—á–Ω—É, —â–æ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ
if ((substr($text, 0, 4) == '+380' and strlen($text) == '13') or (substr($text, 0, 3) == '380' and strlen($text) == '12')) {
  // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ç–∏–ø –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏
  $bot->setupTypeKeyboard('keyboard');
  // –ü–æ–∫–∏ —â–æ –ù–ï –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–æ —Ä—É—á–Ω–µ –≤–≤–µ–¥–µ–Ω–Ω—è –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω—É
  $bot->insertButton([['text' => $sharecontact, 'request_contact' => true]]);
  // –Ø–∫—â–æ –∫–ª—ñ—î–Ω—Ç —â–µ –Ω–µ –≤–∫–∞–∑—É–≤–∞–≤ —Ä–∞–Ω—ñ—à–µ –æ—Å–æ–±–∏—Å—Ç–∏–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É
  if ($bundle['phone'] == '') {
    $bot->reply("–ù–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–æ–¥—ñ–ª–∏—Ç–∏—Å—å —Ç–∏–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω—É, —â–æ –ø—Ä–∏–≤'—è–∑–∞–Ω–æ –¥–æ Telegram –∞–∫–∫–∞—É–Ω—Ç—É.\r\n---\r\n–¢–∞–∫–∏–º —á–∏–Ω–æ–º, –º–∏ —Ä–æ–±–∏–º–æ —Ñ–æ—Ä–º–∞–ª—å–Ω—É –≤–µ—Ä—ñ—Ñ—ñ–∫–∞—Ü—ñ—é –Ω–æ–º–µ—Ä—ñ–≤ –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –∞–±—é–∑–∏–≤–Ω–æ–º—É —Å–ø–∞–º—É.\r\n---\r\n–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—å —Ç–∞ –≤–µ—Ä—ñ—Ñ—ñ–∫—É–≤–∞—Ç–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂—á–µ");
    exit('ok');
    }
    $bot->reply("–ú–∏ –ù–ï –∑–∞–ø–∏—Ç—É–≤–∞–ª–∏ —Ä—É—á–Ω–µ –≤–≤–µ–¥–µ–Ω–Ω—è –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω—É. –Ø–∫—â–æ –í–∏ —Ö–æ—á–µ—Ç–µ –≤–µ—Ä—ñ—Ñ—ñ–∫—É–≤–∞—Ç–∏ (–ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏), –Ω–æ–º–µ—Ä —â–æ –ø—Ä–∏–≤'—è–∑–∞–Ω–æ –¥–æ –ø–æ—Ç–æ—á–Ω–æ–≥–æ Telegram –∞–∫–∫–∞—É–Ω—Ç—É, —Ç–æ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂—á–µ");
  exit('ok');
  }





// –Ø–∫—â–æ –Ω–∞–º –Ω–∞–¥—ñ—Å–ª–∞–ª–∏ –∫–æ–Ω—Ç–∞–∫—Ç
if (!empty($data['message']['contact']['phone_number'])) {
  // –ë–µ—Ä–µ–º–æ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É
  $phone = $data['message']['contact']['phone_number'];
  if (substr($phone, 0, 1) != "+") {
    $phone = '+' . $phone;
    }
  $dopanketa = false;

  // –ß–∏ –ø—Ä–∞—Ü—é—î –¥–∞–Ω–∏–π –±–æ—Ç –∑ –∫—Ä–∞—ó–Ω–æ—é —Ç–µ–ª–µ—Ñ–æ–Ω—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞?
  // –ó–≤—ñ—Ä—è—î–º–æ —Ç–µ–ª–µ—Ñ–æ–Ω –∑ –ø–µ—Ä–µ–ª—ñ–∫—ñ–∫–æ–º –¥–æ–ø—É—Å—Ç–∏–º–∏—Ö –∫–æ–¥—ñ–≤ –∫—Ä–∞—ó–Ω–∏
  $testCountry = core::inar($phone, $setAco['mobileCodes'], true);

  // –†–æ–∑–≤–∏—Ç–æ–∫ –ø–æ–¥—ñ–π –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ä—ñ–∑–Ω–∏–π
  // –ú–æ–∂–Ω–∞ –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –Ω–µ –ø—É—Å–∫–∞—Ç–∏ –¥–∞–ª—ñ —è–∫—â–æ –ª—î–≤–∞ –∫—Ä–∞—ó–Ω–∞
  if ($testCountry != true) {
    $bot->deleteKeyboard();
    $bot->reply('–¶–µ–π –±–æ—Ç –ø—Ä–∞—Ü—é—î –ª–∏—à–µ –∑ ' . strtoupper($botinfo['country']));
    // –¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –±–∞–Ω–∏—Ç–∏ –º–æ—Å–∫–∞–ª—ñ–≤
    if (strpos($phone, "+7") === 0) {
      $bot->tempban($user);
      }
    exit('ok');
    }


  // –û–Ω–æ–≤–ª—é—î–º–æ —É—Å—ñ –∑–∞–ø–∏—Å–∏ —Ü—å–æ–≥–æ —é–∑–µ—Ä–∞
  core::$db->query("UPDATE `" . load::$tg_bundle . "` SET `date_phone`=NOW(), `phone`='$phone' $dopanketa WHERE `from_id`='{$user}'");


  // –Ø–∫—â–æ —Ü–µ —Ç–∏–ø–æ–≤–∞ —Å—Ö–µ–º–∞ –±–æ—Ç—É
  if (empty($partner) or $st == 'bot') {
    $ua = "–î—è–∫—É—î–º–æ, –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ –±–µ–∑–ø–µ—á–Ω–æ–º—É —Å—Ö–æ–≤–∏—â—ñ";
    $ru = "–°–ø–∞—Å–∏–±–æ, –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ";
    $en = "Thank you, your phone number is saved in a safe place";
    $response = mova::lg($lg, $ua, $ru, $en);
    $bot->reply($response);
    exit('ok');
    }

  // –í —ñ–Ω—à–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö
  // –ù–æ–º–µ—Ä c–ø—ñ–≤–ø–∞–¥–∞—î, –∞ –∑–Ω–∞—á–∏—Ç—å –º–æ–∂–µ–º–æ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º –∑–∞–≤–µ—Ä—à—É–≤–∞—Ç–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é
  $ua = "–ê–∫–∫–∞—É–Ω—Ç –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ!\r\n\r\n–¢–µ–ø–µ—Ä –í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–µ—Ä—à–∏—Ç–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é –Ω–∞ —Å–∞–π—Ç—ñ.";
  $ru = "–ê–∫–∫–∞—É–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω!\r\n\r\n–¢–µ–ø–µ—Ä—å –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –Ω–∞ —Å–∞–π—Ç–µ.";
  $en = "Your account has been confirmed!\r\n\r\nNow you can complete your registration on the site.";
  $response = mova::lg($lg, $ua, $ru, $en);
  //
  $bot->reply($response);

  exit('ok');
  }








// –Ø–∫—â–æ —Ü–µ –Ω–µ –¥—ñ–ø–ª—ñ–Ω–∫, –∞ —è–∫–µ—Å—å —á–∏—Å–ª–æ
// –í–≤–∞–∂–∞—î–º–æ, —â–æ –∫–ª—ñ—î–Ω—Ç –≤–≤—ñ–≤ –∫–æ–¥ –ø—Ä–∏–≤'—è–∑–∫–∏ email –¥–æ tg
if (ctype_digit($text) and strlen($text) == '5' and $text >= '30000') {

  // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —Ü–µ –±—É–ª–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
  if ($bundle['kod'] == 'ok' or $bundle['kod'] == '') {
    $ua = "–í–≤–µ–¥–µ–Ω–Ω—è —Ü—å–æ–≥–æ –∫–æ–¥—É –≤—ñ–¥ –í–∞—Å –ù–ï –≤–∏–º–∞–≥–∞–ª–æ—Å—å";
    $ru = "–í–≤–µ–¥–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –∫–æ–¥–∞ –æ—Ç –í–∞—Å –ù–ï —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å";
    $en = "You were NOT required to enter this code.";
    $texts = mova::lg($lg, $ua, $ru, $en);
    $bot->reply($texts);
    exit('ok');
    }
  // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —î –≤–∞–ª—ñ–¥–Ω–∏–π –∫–æ–¥ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
  $kp = tg::testKodProverki($bundle);
  if ($kp != false) {
    $kogdanew = date('H:i d.m.Y', strtotime($bundle['kodtime']) + (60 * 60 * 24));
    if ($bundle['trykod'] >= 3) {
      // We inform you that the client has exhausted the number of attempts to request a code for a day
      $ua = "–ù–∞ –¥–∞–Ω–∏–π –º–æ–º–µ–Ω—Ç –í–∏ –≤–∏—á–µ—Ä–ø–∞–ª–∏ –≤—Å—ñ —Å–ø—Ä–æ–±–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email.\r\n\r\n–ü—ñ—Å–ª—è " . $kogdanew . "—Ä. –í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç–∏ –Ω–æ–≤–∏–π –∫–æ–¥ –ê–ë–û –∑–º—ñ–Ω–∏—Ç–∏ " . $bundle['email'] . " –Ω–∞ —ñ–Ω—à—ñ–π.";
      $ru = "–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –í—ã –∏—Å—á–µ—Ä–ø–∞–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email.\r\n\r\n–ü–æ—Å–ª–µ " . $kogdanew . "–≥. –í—ã —Å–º–æ–∂–µ—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–æ–≤—ã–π –∫–æ–¥ –ò–õ–ò –∏–∑–º–µ–Ω–∏—Ç—å " . $bundle['email'] . " –Ω–∞ –¥—Ä—É–≥–æ–π.";
      $en = "At this point, you have exhausted all attempts to confirm email.\r\n\r\nAfter " . $kogdanew . "y. you will be able to request a new code OR change " . $bundle['email'] . " another.";
      $texts = mova::lg($lg, $ua, $ru, $en);
      $bot->reply($texts);
      exit('ok');
      }

    // –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —Å–ø—ñ–≤–ø–∞–¥–∞—î –∫–æ–¥

    // –ö–æ–¥ –≤–≤–µ–¥–µ–Ω–æ –≤—ñ—Ä–Ω–æ
    if ($text == $bundle['kod']) {
      $ua = "–í–∏ —É—Å–ø—ñ—à–Ω–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω—ñ! –ü—Ä–∏—î–º–Ω–æ—ó —Ä–æ–±–æ—Ç–∏!";
      $ru = "–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã! –ü—Ä–∏—è—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã!";
      $en = "You are successfully registered! Have a nice job!";
      $answerOkReg = mova::lg($lg, $ua, $ru, $en);

      $bot->reply($answerOkReg);

      // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∫—Ä–∞—ó–Ω—É
      if ($bundle['country'] == '') {
        $coset = "`country`='{$botinfo['country']}',";
        } else {
        $coset = false;
        }

      // Save
      core::$db->query("UPDATE `" . load::$tg_bundle . "` SET {$coset} `kod`='ok', `trykod`= '0',`setmail`=NOW() WHERE `from_id`='" . $bundle['from_id'] . "' and `bot`='" . $bundle['bot'] . "'");
      // –ü—Ä–æ –≤—Å—è–∫ –≤–∏–ø–∞–¥–æ–∫ –≤–∏–¥–∞–ª—è—î–º–æ –º–∏–ª–æ –∑ —Ç–∞–±–ª–∏—Ü—ñ –∑ –¥–∏–ø–ª—ñ–Ω–∫–∞–º–∏
      core::$db->query("DELETE FROM `" . load::$tg_deeplink . "` WHERE `email` = '" . $bundle['email'] . "'");
      exit('ok');

      } else {
      // –ö–æ–¥ –≤–≤–µ–¥—ë–Ω –Ω–µ–≤–µ—Ä–Ω–æ
      $ostatoktry = 3 - $bundle['trykod'] - 1;
      $ua = "—Å–ø—Ä–æ–±–∞ —Å–ø—Ä–æ–±–∏ —Å–ø—Ä–æ–±";
      $ru = "–ø–æ–ø—ã—Ç–∫–∞ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–ø—ã—Ç–æ–∫";
      $en = "attempt attempt attempt";
      $popitki = mova::lg($lg, $ua, $ru, $en);
      $try = core::declension($ostatoktry, $popitki);
      if ($ostatoktry >= '1') {
        $ua = "–ó–º—ñ–Ω–∏—Ç–∏ email –Ω–∞ —ñ–Ω—à–∏–π";
        $ru = "–ò–∑–º–µ–Ω–∏—Ç—å email –Ω–∞ –¥—Ä—É–≥–æ–π";
        $en = "Change email to another";
        $klavatext = mova::lg($lg, $ua, $ru, $en);
        // –°–æ–æ–±—â–∞–µ–º —á—Ç–æ –∫–æ–¥ –Ω–µ –≤–µ—Ä–Ω—ã–π
        $ua = "–ö–æ–¥ –ù–ï–í–Ü–†–ù–ò–ô. –£ –≤–∞—Å –∑–∞–ª–∏—à–∏–ª–æ—Å—è **" . $try . "**.\r\n\r\n–í–≤–µ–¥—ñ—Ç—å –∫–æ–¥ —ñ–∑ –ª–∏—Å—Ç–∞ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ–≥–æ –Ω–∞ " . $email . " –∞–±–æ –∑–º—ñ–Ω–∏—Ç–µ email –Ω–∞ —ñ–Ω—à–∏–π.\r\n\r\n–ü—Ä–∏ –∑–º—ñ–Ω—ñ email —É –í–∞—Å –±—É–¥–µ –≤—Å—å–æ–≥–æ –æ–¥–Ω–∞ —Å–ø—Ä–æ–±–∞ –Ω–∞ –¥–æ–±—É, –Ω–∞ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ–¥—É –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ–≥–æ –Ω–∞ –Ω–æ–≤–∏–π email";
        $ru = "–ö–æ–¥ –ù–ï–í–ï–†–ù–´–ô. –£ –í–∞—Å –æ—Å—Ç–∞–ª–æ—Å—å **" . $try . "**.\r\n\r\n–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏–∑ –ø–∏—Å—å–º–∞ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –Ω–∞ " . $email . " –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ email –Ω–∞ –¥—Ä—É–≥–æ–π.\r\n\r\n–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ email —É –í–∞—Å –±—É–¥–µ—Ç –≤—Å–µ–≥–æ –æ–¥–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ –≤ —Å—É—Ç–∫–∏, –Ω–∞ –≤–≤–µ–¥–µ–Ω–∏–µ –∫–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –Ω–∞ –Ω–æ–≤—ã–π email";
        $en = "The code is INCORRECT. You have **" . $try . "**.\r\n\r\nEnter the code from the letter delivered to " . $email . " or change your email to another.\r\n\r\nWhen you change your email, you will have only one attempt per day to enter the code sent to the new email";
        $koderor = mova::lg($lg, $ua, $ru, $en);
        $bot->insertButton([["text" => $klavatext, "callback_data" => "btn_editemail"]]);
        $bot->setupTypeKeyboard('inline_keyboard');
        $bot->reply($koderor);
        } else {
        // We inform you that the client has exhausted the number of attempts to request a code for a day
        $ua = "–ù–∞ –¥–∞–Ω–∏–π –º–æ–º–µ–Ω—Ç –í–∏ –≤–∏—á–µ—Ä–ø–∞–ª–∏ –≤—Å—ñ —Å–ø—Ä–æ–±–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email.\r\n\r\n–ü—ñ—Å–ª—è " . $kogdanew . "—Ä. –í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç–∏ –Ω–æ–≤–∏–π –∫–æ–¥ –ê–ë–û –∑–º—ñ–Ω–∏—Ç–∏ " . $bundle['email'] . " –Ω–∞ —ñ–Ω—à—ñ–π.";
        $ru = "–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –í—ã –∏—Å—á–µ—Ä–ø–∞–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email.\r\n\r\n–ü–æ—Å–ª–µ " . $kogdanew . "–≥. –í—ã —Å–º–æ–∂–µ—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–æ–≤—ã–π –∫–æ–¥ –ò–õ–ò –∏–∑–º–µ–Ω–∏—Ç—å " . $bundle['email'] . " –Ω–∞ –¥—Ä—É–≥–æ–π.";
        $en = "At this point, you have exhausted all attempts to confirm email.\r\n\r\nAfter " . $kogdanew . "y. you will be able to request a new code OR change " . $bundle['email'] . " another.";
        $texts = mova::lg($lg, $ua, $ru, $en);
        $bot->reply($texts);
        }
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ø—ã—Ç–∫—É
      core::$db->query("UPDATE `" . load::$tg_bundle . "` SET `trykod`= `trykod`+1 WHERE `from_id`='" . $user . "' and `bot`='" . $botinfo['name'] . "'");

      exit('ok');
      }

    } else {
    // –µ—Å–ª–∏ –≤–∞–ª–∏–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –Ω–µ—Ç
    $ua = "–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –Ω–æ–≤–∏–π –∫–æ–¥";
    $ru = "–í—ã—Å–ª–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–¥";
    $en = "Send new code";
    $klavatextOne = mova::lg($lg, $ua, $ru, $en);
    $ua = "–ó–º—ñ–Ω–∏—Ç–∏ email –Ω–∞ —ñ–Ω—à–∏–π";
    $ru = "–ò–∑–º–µ–Ω–∏—Ç—å email –Ω–∞ –¥—Ä—É–≥–æ–π";
    $en = "Change email to another";
    $editmailnew = mova::lg($lg, $ua, $ru, $en);
    // –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø—Ä–∏—Å–ª–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É –Ω–æ–≤—ã–π –∫–æ–¥
    $ua = "–¢–µ—Ä–º—ñ–Ω –¥—ñ—ó –∫–æ–¥—É –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è. –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –Ω–∞ " . $bundle['email'] . " –Ω–æ–≤–∏–π –∫–æ–¥ –∞–±–æ –∑–º—ñ–Ω–∏—Ç–∏ email –Ω–∞ —ñ–Ω—à–∏–π?";
    $ru = "–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∫–æ–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏—Å—Ç—ë–∫. –í—ã—Å–ª–∞—Ç—å –Ω–∞ " . $bundle['email'] . " –Ω–æ–≤—ã–π –∫–æ–¥ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å email –Ω–∞ –¥—Ä—É–≥–æ–π?";
    $en = "The verification code has expired. Send to " . $bundle['email'] . " new code or change email to another?";
    $texts = mova::lg($lg, $ua, $ru, $en);
    $bot->insertButton([["text" => $klavatextOne, "callback_data" => "btn_newkod"]]);
    $bot->insertButton([["text" => $editmailnew, "callback_data" => "btn_editemail"]]);
    $bot->setupTypeKeyboard('inline_keyboard');
    $bot->reply($texts);

    if ($bundle['trykod'] >= '1') {
      // –û–±–Ω—É–ª—è–µ–º –ø–æ–ø—ã—Ç–∫–∏
      core::$db->query("UPDATE `" . load::$tg_bundle . "` SET `trykod`= '0' WHERE `from_id`='" . $user . "' and `bot`='" . $botinfo['name'] . "'");
      }
    exit('ok');
    }
  }


if ($isAdmin !== true) {
  // –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –Ω–µ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–æ –ª—ñ–º—ñ—Ç –≤—ñ–¥–ø—Ä–∞–≤–æ–∫ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑–∞ –¥–µ–Ω—å —Ü–∏–º ID
  // ! –í–∏–¥–∞—î–º–æ –∞–Ω—Ç–∏—Å–ø–∞–º –∑–∞–≥–ª—É—à–∫—É —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–¥—ñ—Å–ª–∞–≤ –±—ñ–ª—å—à–µ 50 —Ç–∞–∫–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –±–æ—Ç—É –∑–∞ —Å—É—Ç–∫–∏
  // –ö–Ω–æ–ø–∫–∏ –æ–ø—Ä–∞—Ü—é–æ–≤—É—é—Ç—å—Å—è –≤–∏—â–µ —ñ –ù–ï –ª—ñ–º—ñ—Ç—É—é—Ç—å—Å—è
  // –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω—è –≤ –ø—É–±–ª—ñ—á–Ω—ñ —á–∞—Ç–∏ –æ–ø—Ä–∞—Ü—é–æ–≤—É—é—Ç—å—Å—è –≤–∏—â–µ —ñ —Ç–æ–º—É –ù–ï –ª—ñ–º—ñ—Ç—É—é—Ç—å—Å—è
  // ! –õ—ñ–º—ñ—Ç—É—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –±–æ—Ç—É –∫–æ–º–∞–Ω–¥–∏ —Ç–∞ —Ç–µ–∫—Å—Ç–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–µ –æ–ø–∏—Å–∞–Ω—ñ –≤–∏—â–µ
  $stopspamtext = tg::TelegramSpamProtect($isAdmin, $user, $host, $lg);
  if (!empty($stopspamtext)) {
    $bot->reply($stopspamtext);
    exit('stopspam');
    }
  }

// –Ø–∫—â–æ –ø–µ—Ä–µ–¥ –Ω–∞–º–∏ –µ–º–∞–∏–ª
if (filter_var($text, FILTER_VALIDATE_EMAIL)) { //  and $bundle['kod'] !=

  // –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É—î–º–æ email
  $email = core::buildStandartEmail($text);

  if ($bundle['email'] == $email) {
    // –≠—Ç–æ—Ç email —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –í–∞—à–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É
    $ua = "–¶–µ–π email –≤–∂–µ –ø—Ä—ñ–∫—Ä—ñ–ø–ª–µ–Ω–∏–π –¥–æ –í–∞—à–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É";
    $ru = "–≠—Ç–æ—Ç email —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –í–∞—à–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É";
    $en = "This email is already linked to your account";
    $ujeetotmail = mova::lg($lg, $ua, $ru, $en);
    $bot->reply($ujeetotmail);
    exit('ok');
    }

  // ! –ù–∏–∂—á–µ –ª–∏—à–µ –±–∞–∑–æ–≤–∞ –ª–æ–≥—ñ–∫–∞
  // ! –¶–µ–π —Ç–µ—Å—Ç–æ–≤–∏–π –±–æ—Ç –ù–ï –¥–æ–¥–∞–Ω–∞ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –Ω–∞–¥—Å–∏—Ç–∞–ª–∏ –ª–∏—Å—Ç–∏
  // ! –î–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –¥–ª—è smtp –≤—ñ–¥–ø—Ä–∞–≤–∫–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ phpmailer —Ç–∞ –Ω–µ —Ç—ñ–ª—å–∫–∏
  // –í –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ä–µ–ª—ñ–∑—ñ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –±—É–¥–µ –¥–æ–¥–∞–Ω–æ

  // –¶–µ–π email –Ω–µ –Ω–∞–ª–µ–∂–∏—Ç—å –¥–∞–Ω–æ–º—É ID?
  if ($bundle['email'] != $email) {
    // –®—É–∫–∞—î–º–æ —á–∏ –≤–∑–∞–≥–∞–ª—ñ —Ü–µ–π email —î —É –∑–≤'—è–∑–∫–∞—Ö –≤ –±–∞–∑—ñ
    // –ë–æ email –º–∞—î –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    $tgBundle = tg::SearchTgEmail($email, $bundle['bot']);

    // –Ø–∫—â–æ –ù–ï –∑–Ω–∞–π—à–ª–∏ email –Ω—ñ –≤ –∫–æ–≥–æ –Ü —É –¥–∞–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ email —â–µ –ù–ï –±—É–ª–æ –≤–∫–∞–∑–∞–Ω–æ –î–û–°–¢–û–í–Ü–†–ù–û
    if ($tgBundle == false and ($bundle['email'] == '' or ($bundle['email'] != '' and $bundle['kod'] != 'ok'))) {

      // –®—É–∫–∞—î–º–æ —á–∏ –æ—Ç—Ä–∏–º—É–≤–∞–≤ –∫–ª—ñ—î–Ω—Ç –∫–æ–¥ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ä–∞–Ω—ñ—à–µ
      // –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –∂–∏—Ç—Ç—è –∫–æ–¥—É –ø—Ä–∏–ø—É—Å—Ç–∏–º–æ –î–û–ë–ò
      $kp = tg::testKodProverki($bundle);

      if ($kp['needre'] == true) {
        // –ù–∞–¥—Å–∏–ª–∞—î–º–æ –ª–∏—Å—Ç–∞ –∑ –∫–æ–¥–æ–º
        // ! –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—ñ—î—ó —Ñ—É–Ω–∫—Ü—ñ—ó –≤ –º–æ—î–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –±—ñ–±–ª—ñ–æ—Ç–µ–∫ !!
        // tg::SendKod($botinfo, $user, $lg, $aco, $host, $isAdmin, $site, $infoemail, $email);
        // ! –ù–∞–¥—Å–∏–ª–∞—ç–º–æ –∑–∞–≥–ª—É—à–∫—É
        $bot->reply("Here we were supposed to send an email with the code, but we didn‚Äôt send it because the necessary libraries were not connected to the bot");
        exit('ok');
        }
      //
      $ua = "–ó–º—ñ–Ω–∏—Ç–∏ email –Ω–∞ —ñ–Ω—à–∏–π";
      $ru = "–ò–∑–º–µ–Ω–∏—Ç—å email –Ω–∞ –¥—Ä—É–≥–æ–π";
      $en = "Change email to another";
      $editmailnew = mova::lg($lg, $ua, $ru, $en);
      // –ú—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –∫–æ–¥ –∏ –ø—Ä–æ—Å–∏–º –≤–≤–µ—Å—Ç–∏ –µ–≥–æ
      $ua = "—Ä. –º–∏ –Ω–∞–¥—ñ—Å–ª–∞–ª–∏ –Ω–∞ " . $text . " –ª–∏—Å—Ç –∑ –∫–æ–¥–æ–º.\r\n\r\n–ù–µ–º–∞—î –ª–∏—Å—Ç–∞? –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å–ø–∞–º. –©–æ–± –ø–æ—á–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è –±–æ—Ç–æ–º, –≤–≤–µ–¥—ñ—Ç—å –ö–û–î –∑ –ª–∏—Å—Ç–∞ –∞–±–æ –∑–º—ñ–Ω—ñ—Ç—å email –Ω–∞ —ñ–Ω—à–∏–π";
      $ru = "–≥. –º—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –Ω–∞ " . $text . " –ø–∏—Å—å–º–æ —Å –∫–æ–¥–æ–º.\r\n\r\n–ù–µ—Ç –ø–∏—Å—å–º–∞? –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∞–º.\r\n\r\n–ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º, –≤–≤–µ–¥–∏—Ç–µ –ö–û–î –∏–∑ –ø–∏—Å—å–º–∞ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ email –Ω–∞ –¥—Ä—É–≥–æ–π";
      $en = "y. we sent to " . $text . " letter with code.\r\n\r\nNo letter? Check spam.\r\n\r\nTo start using the bot, enter the CODE from the letter or change your email to another";
      $texts = mova::lg($lg, "–û", "–í", "At") . " " . $kp['kodtime'] . mova::lg($lg, $ua, $ru, $en);
      $bot->insertButton([["text" => $editmailnew, "callback_data" => "btn_editemail"]]);
      $bot->reply($texts);
      exit('ok');

      }

    // –ï—Å–ª–∏ –ù–ï –Ω–∞—à–ª–∏ –º—ã–ª–æ –≤ —Å–≤—è–∑–∫–∞—Ö –ò —É –∫–ª–∏–µ–Ω—Ç–∞ —É–∂–µ –µ—Å—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–µ –º—ã–ª–æ
    if ($tgBundle == false and $bundle['email'] != '' and $bundle['kod'] == 'ok') {
      $ua = "–ó–º—ñ–Ω–∏—Ç–∏ email –Ω–∞ —ñ–Ω—à–∏–π";
      $ru = "–ò–∑–º–µ–Ω–∏—Ç—å email –Ω–∞ –¥—Ä—É–≥–æ–π";
      $en = "Change email to another";
      $editmailnew = mova::lg($lg, $ua, $ru, $en);
      $ua = "–ó–∞–ª–∏—à–∏—Ç–∏ —Å—Ç–∞—Ä–∏–π email";
      $ru = "–û—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–π email";
      $en = "Leave old email";
      $leaveoldmail = mova::lg($lg, $ua, $ru, $en);

      // need to inform the client
      // Ask if the client really wants to change the current email to a new one  
      $ua = "–í–∞—à –ø–æ—Ç–æ—á–Ω–∏–π email:\r\n\r\n" . $email . "\r\n\r\n–ó–º—ñ–Ω–∏—Ç–∏ –π–æ–≥–æ –Ω–∞ –Ω–æ–≤–∏–π:\r\n\r\n" . $text . "\r\n\r\n?";
      $ru = "–í–∞—à —Ç–µ–∫—É—â–∏–π email:\r\n\r\n" . $email . "\r\n\r\n–ò–∑–º–µ–Ω–∏—Ç—å –µ–≥–æ –Ω–∞ –Ω–æ–≤—ã–π:\r\n\r\n" . $text . "\r\n\r\n?";
      $en = "Your current email:\r\n\r\n" . $email . "\r\n\r\nLet's change it to a new one:\r\n\r\n" . $text . "\r\n\r\n?";
      $oldmaileditnew = mova::lg($lg, $ua, $ru, $en);
      $bot->insertButton([["text" => $editmailnew, "callback_data" => "btn_editemail"]]);
      $bot->insertButton([["text" => $leaveoldmail, "callback_data" => "btn_oldmail"]]);
      $bot->reply($oldmaileditnew);
      exit('ok');
      }
    // –ï—Å–ª–∏ —É –∫–ª–∏–µ–Ω—Ç–∞ —Ä–∞–Ω–µ–µ –±—ã–ª–æ —É–∫–∞–∑–∞–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–µ –º—ã–ª–æ –∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –≤ —á—ë—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ
    //if($bundle['email'] != '' and $bundle['kod'] == 'ok' and (empty($client) or $client['status'] != 'black') ){ /**/ }
    }








  } // –ö—ñ–Ω–µ—Ü—å –æ–±—Ä–æ–±–∫–∏ –º–∏–ª–∞






// –ê–¥–º—ñ–Ω—Å—å–∫–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª —Ä–µ–∞–ª—ñ–∑–æ–≤—É—î—Ç—å—Å—è —Ç—É—Ç
if ($isAdmin === true) {
  // –ü–æ–∫–∞–∑–∞—Ç–∏ –º–µ–Ω—é –∞–¥–º—ñ–Ω–∞ —è–∫—â–æ –≤ —á–∞—Ç –∞–¥–º—ñ–Ω –≤–≤—ñ–≤ —Å–ª–æ–≤–æ admin
  if (stristr($text, 'admin') !== false) {
    $bot->insertButton([["text" => "Admin test", "callback_data" => "button_one"]]);
    $bot->reply("Control bot");
    exit('ok');
    }

  } // admin


// –Ø–∫—â–æ –∫–ª—ñ—î–Ω—Ç –Ω–∞—Ç–∏—Å–Ω—É–≤ —Å—Ç–∞—Ä—Ç, —â–æ –π–æ–º—É –ø–∏—Å–∞—Ç–∏
if (!empty($command[0]) and $command[0] === '/start') {
  // –ü—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ –∞–±–æ —Ä–µ—Å—Ç–∞—Ä—Ç—ñ –≤–∏–¥–∞–ª—è—î–º–æ –≤—Å—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏
  // –ë–æ —á–∞—Å—Ç–æ –∫–Ω–æ–ø–∫–∞ –≤–µ—Ä—ñ—Ñ—ñ–∫–∞—Ü—ñ—ó –Ω–æ–º–µ—Ä–∞ –≤–∏—Å–∏—Ç—å —á–∏ —è–∫–µ—Å—å –º–µ–Ω—é —è–∫–µ –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç—ñ —Å—Ç–∞—î –Ω–µ–ª–æ–≥—ñ—á–Ω–∏–º
  // –î–ª—è —Ü—å–æ–≥–æ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º API —ñ—Å–Ω—É—î –µ–¥–∏–Ω–∏–π –Ω–∏–Ω—ñ –≤–µ–ª–æ—Å–∏–ø–µ–¥–Ω–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º:
  // —Ç—Ä–µ–±–∞ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–µ–∑ –∫–ª–∞–≤—É–∞—Ç—É—Ä–∏ —ñ –≤–∏–¥–∞–ª–∏—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ
  // –¢–æ–∂ –¥–ª—è —Ü—å–æ–≥–æ –º–æ–∂–Ω–∞ –ø—Ä–æ—Å—Ç–æ –Ω—ñ–±–∏ —è–∫ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –ø—Ä–∏–≤—ñ—Ç–∞—Ç–∏—Å—å
  // –ù–µ –≤–∞—Ä—Ç–æ –≤ —Ü—å–æ–º—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—ñ –Ω–∞–¥—Å–∏—Ç–∞–ª–∏ –≤–∞–∂–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó
  $bot->deleteKeyboard();
  $hi = mova::lg($lg, "–í—ñ—Ç–∞—î–º–æ!", "–ü—Ä–∏–≤–µ—Ç!", "Hi!");
  $bot->reply($hi);
  $bot->setupTypeKeyboard('inline_keyboard');

  // –ü–æ—Ç—ñ–º –Ω–∞–¥—Å–∏–ª–∞—î–º–æ —Å—Ç–∞—Ä—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ –≤–∞–∂–ª–∏–≤–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é
  // (–º–æ–∂–ª–∏–≤–æ —Å–ø–µ—Ä—à—É –±–µ—Ä–µ–º–æ –∑ –±–∞–∑–∏, –∞ —è–∫—â–æ —Ç–∞–º –Ω–µ–º–∞—î - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ)
  // –ë—Ä–∞—Ç–∏ –∑ –±–∞–∑–∏ –∑—Ä—É—á–Ω–æ, —â–æ–± –≤–æ–Ω–æ –º–æ–≥–ª–æ –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º —ñ –Ω–∞–≤—ñ—Ç—å "–Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–º"
  // !–ê–ª–µ –Ω–µ–∑—Ä—É—á–Ω–æ —É –≤–∏–ø–∞–¥–∫—É –±–∞–≥–∞—Ç–æ–º–æ–≤–Ω–æ–≥–æ –±–æ—Ç—É
  if ($botinfo['hello'] != '') {
    $response = $botinfo['hello'];
    } else {
    $ua = "–ë–æ—Ç –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ";
    $ru = "–ë–æ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω";
    $en = "The bot is activated";
    $response = mova::lg($lg, $ua, $ru, $en);
    }
  $bot->reply($response);
  exit('ok');
  }

// –ó–ê–ì–õ–£–®–ö–ê –í–ö–Ü–ù–¶–Ü
// –Ø–∫—â–æ –º–∏ –ø—Ä–∏–π—à–ª–∏ —Å—é–¥–∏, –∑–Ω–∞—á–∏—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤—ñ–≤ –∫–æ–º–∞–Ω–¥—É —è–∫—É –±–æ—Ç –Ω–µ –≤–º—ñ—î –æ–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞—Ç–∏
$ua = "–Ø –Ω–µ –≤–º—ñ—é –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ —Ç–∞–∫–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏.\r\n\r\n–Ø –±–æ—Ç - —è–∫–∏–π –Ω–∞—Ä–∞–∑—ñ –Ω–µ –º–∞—î —à—Ç—É—á–Ω–æ–≥–æ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É. –Ø –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ–Ω—É—é –Ω–∞–ø–µ—Ä–µ–¥ –∑–∞–≥–æ—Ç–æ–≤–ª–µ–Ω—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è. –Ø –Ω–µ –∑–¥–∞—Ç–Ω–∏–π –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –±–µ—Å—ñ–¥—É –∞–±–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –Ω–∞ –∑–∞–ø–∏—Ç–∏ —Ç–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —Ç–æ–º—É —â–æ —Ü–µ –Ω–µ –≤—Ö–æ–¥–∏—Ç—å –¥–æ –∑–æ–Ω–∏ –º–æ—î—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ.";
$ru = "–Ø –Ω–µ —É–º–µ—é —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∞–∫–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏.\r\n\r\n–Ø –±–æ—Ç - –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –æ–±–ª–∞–¥–∞–µ—Ç –∏—Å–∫—É—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–µ–∫—Ç–æ–º. –Ø –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω—è—é –∑–∞—Ä–∞–Ω–µ–µ –∑–∞–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ –∑–∞–¥–∞—á–∏. –Ø –Ω–µ —Å–ø–æ—Å–æ–±–µ–Ω –∫–∞–∫ –ª–∏–±–æ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –±–µ—Å–µ–¥–∞—Ö –∏–ª–∏ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ –∑–æ–Ω—É –º–æ–µ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.";
$en = "I can't work with such commands.\r\n\r\nI am a bot - which does not yet have artificial intelligence. I simply perform pre-arranged specific procedural tasks. I am unable to participate in conversations or respond to requests and messages, as this is not my responsibility.";
$bot->insertButton([['text' => "GO TO START", 'callback_data' => "/start"]]);
$response = mova::lg($lg, $ua, $ru, $en);
$bot->reply($response);

exit('ok');